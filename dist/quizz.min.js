!function(){var t={436:function(t,e,n){"use strict";var i=n(81),r=n.n(i),o=n(645),s=n.n(o)()(r());s.push([t.id,'/*\n   * MathQuill v0.10.1, by Han, Jeanine, and Mary\n   * http://mathquill.com | maintainers@mathquill.com\n   *\n   * This Source Code Form is subject to the terms of the\n   * Mozilla Public License, v. 2.0. If a copy of the MPL\n   * was not distributed with this file, You can obtain\n   * one at http://mozilla.org/MPL/2.0/.\n   */\n@font-face {\n    font-family: Symbola;\n    src: url(https://piworld.es/iedib/mqwidgets2/fonts/Symbola.eot);\n    src: local("Symbola Regular"), local("Symbola"), url(https://piworld.es/iedib/mqwidgets2/fonts/Symbola.woff2) format("woff2"), url(https://piworld.es/iedib/mqwidgets2/fonts/Symbola.woff) format("woff"), url(https://piworld.es/iedib/mqwidgets2/fonts/Symbola.ttf) format("truetype"), url(https://piworld.es/iedib/mqwidgets2/fonts/Symbola.svg#Symbola) format("svg");\n}\n\n.mq-editable-field {\n    display: -moz-inline-box;\n    display: inline-block;\n}\n\n.mq-editable-field .mq-cursor {\n    border-left: 1px solid black;\n    margin-left: -1px;\n    position: relative;\n    z-index: 1;\n    padding: 0;\n    display: -moz-inline-box;\n    display: inline-block;\n}\n\n.mq-editable-field .mq-cursor.mq-blink {\n    visibility: hidden;\n}\n\n.mq-editable-field,\n.mq-math-mode .mq-editable-field {\n    border: 1px solid gray;\n}\n\n.mq-editable-field.mq-focused,\n.mq-math-mode .mq-editable-field.mq-focused {\n    -webkit-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n    -moz-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n    box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n    border-color: #709AC0;\n    border-radius: 1px;\n}\n\n.mq-math-mode .mq-editable-field {\n    margin: 1px;\n}\n\n.mq-editable-field .mq-latex-command-input {\n    color: inherit;\n    font-family: "Courier New", monospace;\n    border: 1px solid gray;\n    padding-right: 1px;\n    margin-right: 1px;\n    margin-left: 2px;\n}\n\n.mq-editable-field .mq-latex-command-input.mq-empty {\n    background: transparent;\n}\n\n.mq-editable-field .mq-latex-command-input.mq-hasCursor {\n    border-color: ActiveBorder;\n}\n\n.mq-editable-field.mq-empty:after,\n.mq-editable-field.mq-text-mode:after,\n.mq-math-mode .mq-empty:after {\n    visibility: hidden;\n    content: \'c\';\n}\n\n.mq-editable-field .mq-cursor:only-child:after,\n.mq-editable-field .mq-textarea+.mq-cursor:last-child:after {\n    visibility: hidden;\n    content: \'c\';\n}\n\n.mq-editable-field .mq-text-mode .mq-cursor:only-child:after {\n    content: \'\';\n}\n\n.mq-editable-field.mq-text-mode {\n    overflow-x: auto;\n    overflow-y: hidden;\n}\n\n.mq-root-block,\n.mq-math-mode .mq-root-block {\n    display: -moz-inline-box;\n    display: inline-block;\n    width: 100%;\n    padding: 2px;\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n    white-space: nowrap;\n    overflow: hidden;\n    vertical-align: middle;\n}\n\n.mq-math-mode {\n    font-variant: normal;\n    font-weight: normal;\n    font-style: normal;\n    font-size: 115%;\n    line-height: 1;\n    display: -moz-inline-box;\n    display: inline-block;\n}\n\n.mq-math-mode .mq-non-leaf,\n.mq-math-mode .mq-scaled {\n    display: -moz-inline-box;\n    display: inline-block;\n}\n\n.mq-math-mode var,\n.mq-math-mode .mq-text-mode,\n.mq-math-mode .mq-nonSymbola {\n    font-family: "Times New Roman", Symbola, serif;\n    line-height: .9;\n}\n\n.mq-math-mode * {\n    font-size: inherit;\n    line-height: inherit;\n    margin: 0;\n    padding: 0;\n    border-color: black;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n    box-sizing: border-box;\n}\n\n.mq-math-mode .mq-empty {\n    background: #ccc;\n}\n\n.mq-math-mode .mq-empty.mq-root-block {\n    background: transparent;\n}\n\n.mq-math-mode.mq-empty {\n    background: transparent;\n}\n\n.mq-math-mode .mq-text-mode {\n    display: inline-block;\n    white-space: pre;\n}\n\n.mq-math-mode .mq-text-mode.mq-hasCursor {\n    box-shadow: inset darkgray 0 .1em .2em;\n    padding: 0 .1em;\n    margin: 0 -0.1em;\n    min-width: 1ex;\n}\n\n.mq-math-mode .mq-font {\n    font: 1em "Times New Roman", Symbola, serif;\n}\n\n.mq-math-mode .mq-font * {\n    font-family: inherit;\n    font-style: inherit;\n}\n\n.mq-math-mode b,\n.mq-math-mode b.mq-font {\n    font-weight: bolder;\n}\n\n.mq-math-mode var,\n.mq-math-mode i,\n.mq-math-mode i.mq-font {\n    font-style: italic;\n}\n\n.mq-math-mode var.mq-f {\n    margin-right: 0.2em;\n    margin-left: 0.1em;\n}\n\n.mq-math-mode .mq-roman var.mq-f {\n    margin: 0;\n}\n\n.mq-math-mode big {\n    font-size: 200%;\n}\n\n.mq-math-mode .mq-int>big {\n    display: inline-block;\n    -webkit-transform: scaleX(0.7);\n    -moz-transform: scaleX(0.7);\n    -ms-transform: scaleX(0.7);\n    -o-transform: scaleX(0.7);\n    transform: scaleX(0.7);\n    vertical-align: -0.16em;\n}\n\n.mq-math-mode .mq-int>.mq-supsub {\n    font-size: 80%;\n    vertical-align: -1.1em;\n    padding-right: .2em;\n}\n\n.mq-math-mode .mq-int>.mq-supsub>.mq-sup>.mq-sup-inner {\n    vertical-align: 1.3em;\n}\n\n.mq-math-mode .mq-int>.mq-supsub>.mq-sub {\n    margin-left: -0.35em;\n}\n\n.mq-math-mode .mq-roman {\n    font-style: normal;\n}\n\n.mq-math-mode .mq-sans-serif {\n    font-family: sans-serif, Symbola, serif;\n}\n\n.mq-math-mode .mq-monospace {\n    font-family: monospace, Symbola, serif;\n}\n\n.mq-math-mode .mq-overline {\n    border-top: 1px solid black;\n    margin-top: 1px;\n}\n\n.mq-math-mode .mq-underline {\n    border-bottom: 1px solid black;\n    margin-bottom: 1px;\n}\n\n.mq-math-mode .mq-binary-operator {\n    padding: 0 0.2em;\n    display: -moz-inline-box;\n    display: inline-block;\n}\n\n.mq-math-mode .mq-supsub {\n    text-align: left;\n    font-size: 90%;\n    vertical-align: -0.5em;\n}\n\n.mq-math-mode .mq-supsub.mq-sup-only {\n    vertical-align: .5em;\n}\n\n.mq-math-mode .mq-supsub.mq-sup-only .mq-sup {\n    display: inline-block;\n    vertical-align: text-bottom;\n}\n\n.mq-math-mode .mq-supsub .mq-sup {\n    display: block;\n}\n\n.mq-math-mode .mq-supsub .mq-sub {\n    display: block;\n    float: left;\n}\n\n.mq-math-mode .mq-supsub .mq-binary-operator {\n    padding: 0 .1em;\n}\n\n.mq-math-mode .mq-supsub .mq-fraction {\n    font-size: 70%;\n}\n\n.mq-math-mode sup.mq-nthroot {\n    font-size: 80%;\n    vertical-align: 0.8em;\n    margin-right: -0.6em;\n    margin-left: .2em;\n    min-width: .5em;\n}\n\n.mq-math-mode .mq-paren {\n    padding: 0 .1em;\n    vertical-align: top;\n    -webkit-transform-origin: center .06em;\n    -moz-transform-origin: center .06em;\n    -ms-transform-origin: center .06em;\n    -o-transform-origin: center .06em;\n    transform-origin: center .06em;\n}\n\n.mq-math-mode .mq-paren.mq-ghost {\n    color: silver;\n}\n\n.mq-math-mode .mq-paren+span {\n    margin-top: .1em;\n    margin-bottom: .1em;\n}\n\n.mq-math-mode .mq-array {\n    vertical-align: middle;\n    text-align: center;\n}\n\n.mq-math-mode .mq-array>span {\n    display: block;\n}\n\n.mq-math-mode .mq-operator-name {\n    font-family: Symbola, "Times New Roman", serif;\n    line-height: .9;\n    font-style: normal;\n}\n\n.mq-math-mode var.mq-operator-name.mq-first {\n    padding-left: .2em;\n}\n\n.mq-math-mode var.mq-operator-name.mq-last,\n.mq-math-mode .mq-supsub.mq-after-operator-name {\n    padding-right: .2em;\n}\n\n.mq-math-mode .mq-fraction {\n    font-size: 90%;\n    text-align: center;\n    vertical-align: -0.4em;\n    padding: 0 .2em;\n}\n\n.mq-math-mode .mq-fraction,\n.mq-math-mode .mq-large-operator,\n.mq-math-mode x:-moz-any-link {\n    display: -moz-groupbox;\n}\n\n.mq-math-mode .mq-fraction,\n.mq-math-mode .mq-large-operator,\n.mq-math-mode x:-moz-any-link,\n.mq-math-mode x:default {\n    display: inline-block;\n}\n\n.mq-math-mode .mq-numerator,\n.mq-math-mode .mq-denominator,\n.mq-math-mode .mq-dot-recurring {\n    display: block;\n}\n\n.mq-math-mode .mq-numerator {\n    padding: 0 0.1em;\n}\n\n.mq-math-mode .mq-denominator {\n    border-top: 1px solid;\n    float: right;\n    width: 100%;\n    padding: 0.1em;\n}\n\n.mq-math-mode .mq-dot-recurring {\n    text-align: center;\n    height: 0.3em;\n}\n\n.mq-math-mode .mq-sqrt-prefix {\n    padding-top: 0;\n    position: relative;\n    top: 0.1em;\n    vertical-align: top;\n    -webkit-transform-origin: top;\n    -moz-transform-origin: top;\n    -ms-transform-origin: top;\n    -o-transform-origin: top;\n    transform-origin: top;\n}\n\n.mq-math-mode .mq-sqrt-stem {\n    border-top: 1px solid;\n    margin-top: 1px;\n    padding-left: .15em;\n    padding-right: .2em;\n    margin-right: .1em;\n    padding-top: 1px;\n}\n\n.mq-math-mode .mq-diacritic-above {\n    display: block;\n    text-align: center;\n    line-height: .4em;\n}\n\n.mq-math-mode .mq-diacritic-stem {\n    display: block;\n    text-align: center;\n}\n\n.mq-math-mode .mq-hat-prefix {\n    display: block;\n    text-align: center;\n    line-height: .95em;\n    margin-bottom: -0.7em;\n    transform: scaleX(1.5);\n    -moz-transform: scaleX(1.5);\n    -o-transform: scaleX(1.5);\n    -webkit-transform: scaleX(1.5);\n}\n\n.mq-math-mode .mq-hat-stem {\n    display: block;\n}\n\n.mq-math-mode .mq-large-operator {\n    vertical-align: -0.2em;\n    padding: .2em;\n    text-align: center;\n}\n\n.mq-math-mode .mq-large-operator .mq-from,\n.mq-math-mode .mq-large-operator big,\n.mq-math-mode .mq-large-operator .mq-to {\n    display: block;\n}\n\n.mq-math-mode .mq-large-operator .mq-from,\n.mq-math-mode .mq-large-operator .mq-to {\n    font-size: 80%;\n}\n\n.mq-math-mode .mq-large-operator .mq-from {\n    float: right;\n    /* take out of normal flow to manipulate baseline */\n    width: 100%;\n}\n\n.mq-math-mode,\n.mq-math-mode .mq-editable-field {\n    cursor: text;\n    font-family: Symbola, "Times New Roman", serif;\n}\n\n.mq-math-mode .mq-overarc {\n    border-top: 1px solid black;\n    -webkit-border-top-right-radius: 50% .3em;\n    -moz-border-radius-topright: 50% .3em;\n    border-top-right-radius: 50% .3em;\n    -webkit-border-top-left-radius: 50% .3em;\n    -moz-border-radius-topleft: 50% .3em;\n    border-top-left-radius: 50% .3em;\n    margin-top: 1px;\n    padding-top: 0.15em;\n}\n\n.mq-math-mode .mq-overarrow {\n    min-width: .5em;\n    border-top: 1px solid black;\n    margin-top: 1px;\n    padding-top: 0.2em;\n    text-align: center;\n}\n\n.mq-math-mode .mq-overarrow:before {\n    display: block;\n    position: relative;\n    top: -0.34em;\n    font-size: 0.5em;\n    line-height: 0em;\n    content: \'\\27A4\';\n    text-align: right;\n}\n\n.mq-math-mode .mq-overarrow.mq-arrow-left:before {\n    -moz-transform: scaleX(-1);\n    -o-transform: scaleX(-1);\n    -webkit-transform: scaleX(-1);\n    transform: scaleX(-1);\n    filter: FlipH;\n    -ms-filter: "FlipH";\n}\n\n.mq-math-mode .mq-overarrow.mq-arrow-both {\n    vertical-align: text-bottom;\n}\n\n.mq-math-mode .mq-overarrow.mq-arrow-both.mq-empty {\n    min-height: 1.23em;\n}\n\n.mq-math-mode .mq-overarrow.mq-arrow-both.mq-empty:after {\n    top: -0.34em;\n}\n\n.mq-math-mode .mq-overarrow.mq-arrow-both:before {\n    -moz-transform: scaleX(-1);\n    -o-transform: scaleX(-1);\n    -webkit-transform: scaleX(-1);\n    transform: scaleX(-1);\n    filter: FlipH;\n    -ms-filter: "FlipH";\n}\n\n.mq-math-mode .mq-overarrow.mq-arrow-both:after {\n    display: block;\n    position: relative;\n    top: -2.3em;\n    font-size: 0.5em;\n    line-height: 0em;\n    content: \'\\27A4\';\n    visibility: visible;\n    text-align: right;\n}\n\n.mq-math-mode .mq-matrix {\n    vertical-align: middle;\n    margin-left: 0.1em;\n    margin-right: 0.1em;\n}\n\n.mq-math-mode .mq-matrix table {\n    width: auto;\n    border-bottom: none;\n    border-spacing: 3px;\n    border-collapse: separate;\n}\n\n.mq-math-mode .mq-matrix table.mq-rows-1 {\n    /* better alignment when there\'s just one row */\n    vertical-align: middle;\n    margin-bottom: 1px;\n}\n\n.mq-math-mode .mq-matrix td {\n    border: none;\n    width: auto;\n    /* defensive resets */\n    padding: 0.1em 0.3em;\n    vertical-align: baseline;\n}\n\n.mq-math-mode .mq-selection,\n.mq-editable-field .mq-selection,\n.mq-math-mode .mq-selection .mq-non-leaf,\n.mq-editable-field .mq-selection .mq-non-leaf,\n.mq-math-mode .mq-selection .mq-scaled,\n.mq-editable-field .mq-selection .mq-scaled {\n    background: #B4D5FE !important;\n    background: Highlight !important;\n    color: HighlightText;\n    border-color: HighlightText;\n}\n\n.mq-math-mode .mq-selection .mq-matrixed,\n.mq-editable-field .mq-selection .mq-matrixed {\n    background: #39F !important;\n}\n\n.mq-math-mode .mq-selection .mq-matrixed-container,\n.mq-editable-field .mq-selection .mq-matrixed-container {\n    filter: progid:DXImageTransform.Microsoft.Chroma(color=\'#3399FF\') !important;\n}\n\n.mq-math-mode .mq-selection.mq-blur,\n.mq-editable-field .mq-selection.mq-blur,\n.mq-math-mode .mq-selection.mq-blur .mq-non-leaf,\n.mq-editable-field .mq-selection.mq-blur .mq-non-leaf,\n.mq-math-mode .mq-selection.mq-blur .mq-scaled,\n.mq-editable-field .mq-selection.mq-blur .mq-scaled,\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed,\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed {\n    background: #D4D4D4 !important;\n    color: black;\n    border-color: black;\n}\n\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed-container,\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed-container {\n    filter: progid:DXImageTransform.Microsoft.Chroma(color=\'#D4D4D4\') !important;\n}\n\n.mq-editable-field .mq-textarea,\n.mq-math-mode .mq-textarea {\n    position: relative;\n    -webkit-user-select: text;\n    -moz-user-select: text;\n    user-select: text;\n}\n\n.mq-editable-field .mq-textarea *,\n.mq-math-mode .mq-textarea *,\n.mq-editable-field .mq-selectable,\n.mq-math-mode .mq-selectable {\n    -webkit-user-select: text;\n    -moz-user-select: text;\n    user-select: text;\n    position: absolute;\n    clip: rect(1em 1em 1em 1em);\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n    -ms-transform: scale(0);\n    -o-transform: scale(0);\n    transform: scale(0);\n    resize: none;\n    width: 1px;\n    height: 1px;\n    box-sizing: content-box;\n}\n\n.mq-math-mode .mq-matrixed {\n    background: white;\n    display: -moz-inline-box;\n    display: inline-block;\n}\n\n.mq-math-mode .mq-matrixed-container {\n    filter: progid:DXImageTransform.Microsoft.Chroma(color=\'white\');\n    margin-top: -0.1em;\n}\n\n/* Josep fixes */\n\ntable.mq-non-leaf td[mathquill-block-id] {\n    padding: 4px 8px;\n    text-align: center;\n}\n\n.mq-math-mode sup.mq-nthroot {\n    font-size: 75%;\n    vertical-align: 0.4em;\n}\n\n.mq-root-block {\n    padding: 5px;\n}\n\n.mq-root-block,\n.mq-math-mode .mq-root-block {\n    padding: 5px;\n}\n\n/*\n  .mq-math-mode .mq-supsub.mq-sup-only {\n    vertical-align: .5em!important;\n  }\n  */\n.mq-math-mode .mq-supsub.mq-sup-only>.mq-sup {\n    font-size: 90%;\n}\n\n.mq-nthroot.mq-non-leaf {\n    padding: 8px 0 !important;\n}\n\n\n/*larger editor on pygen*/\n/*TODO: must be reduced to standard in cloze*/\ndiv[data-pygen] span.mq-editable-field {\n    min-width: 250px;\n}\n\ndiv[data-pygen] .pygen-cloze span.mq-editable-field {\n    min-width: initial;\n}\n\ndiv[data-pygen] .pw-me-editorinput {\n    margin-bottom: 40px;\n}\n\n/* Power in palette */\ndiv.pw-me-tabmenu .mq-supsub.mq-non-leaf.mq-sup-only {\n    vertical-align: super !important;\n}',""]),e.Z=s},982:function(t,e,n){"use strict";var i=n(81),r=n.n(i),o=n(645),s=n.n(o)()(r());s.push([t.id,".ib-quizz-right {\n    margin-left: 8px;\n    border-radius:50%;\n    background-color: rgb(67, 140, 67);\n    color: white;\n    width: 23px;\n    display: inline-block;\n    height: 23px;\n    text-align: center;\n}\n.ib-quizz-wrong {\n    margin-left: 8px;\n    border-radius:50%;\n    background-color: rgb(164, 60, 60);\n    color: white;\n    width: 23px;\n    display: inline-block;\n    height: 23px;\n    text-align: center;\n}\n.ib-quizz-error {\n    margin-left: 8px;\n    border-radius:50%;\n    background-color: rgb(114, 57, 90);\n    color: white;\n    width: 23px;\n    display: inline-block;\n    height: 23px;\n    text-align: center;\n} \n.ib-quizz-hint, .ib-quizz-feedback {\n    margin-left: 8px;\n    border-radius:50%;\n    background-color: rgb(163, 163, 163);\n    color: black;\n    width: 23px;\n    display: inline-block;\n    height: 23px;\n    text-align: center;\n    cursor: pointer;\n} ",""]),e.Z=s},645:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&s[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},81:function(t){"use strict";t.exports=function(t){return t[1]}},379:function(t){"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},s=[],a=0;a<t.length;a++){var l=t[a],c=i.base?l[0]+i.base:l[0],u=o[c]||0,f="".concat(c," ").concat(u);o[c]=u+1;var h=n(f),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)e[h].references++,e[h].updater(d);else{var p=r(d,i);i.byIndex=a,e.splice(a,0,{identifier:f,updater:p,references:1})}s.push(f)}return s}function r(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var l=i(t,r),c=0;c<o.length;c++){var u=n(o[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}o=l}}},569:function(t){"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:function(t){"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:function(t,e,n){"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:function(t){"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:function(t){"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},625:function(){window.ibComponentLoader=function(){function t(){}function e(t){var e=t.length-1;return function(){var n=b.call(arguments,0,e),i=b.call(arguments,e);return t.apply(this,n.concat([i]))}}function n(t){return e((function(e,n){"function"!=typeof e&&(e=g(e));return t.call(this,(function(t){return e.apply(t,[t].concat(n))}))}))}function i(t){var e=b.call(arguments,1);return function(){return t.apply(this,e)}}function r(t,e){if(!e)throw new Error("prayer failed: "+t)}function o(t){r("a direction was passed",t===y||t===w)}function s(t,e,n){r("a parent is always present",t),r("leftward is properly set up",e?e[w]===n&&e.parent===t:t.ends[y]===n),r("rightward is properly set up",n?n[y]===e&&n.parent===t:t.ends[w]===e)}function a(){window.console&&console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')}function l(t){return a(),Dt(t)}function c(e){function n(t){var e,n;return t&&t.nodeType?(n=(e=q(t).children(".mq-root-block").attr(It))&&k.byId[e].controller)?r[n.KIND_OF_MQ](n):null:null}function i(t,e){var n,i,o;for(n in e&&e.handlers&&(e.handlers={fns:e.handlers,APIClasses:r}),e)e.hasOwnProperty(n)&&(i=e[n],o=A[n],t[n]=o?o(i):i)}var r,o,s;if(!(R<=e&&e<=L))throw"Only interface versions between "+R+" and "+L+" supported. You specified: "+e;for(s in r={},n.L=y,n.R=w,n.saneKeyboardEvents=I,n.config=function(t){return i(z.p,t),this},n.registerEmbed=function(t,e){if(!/^[a-z][a-z0-9]*$/i.test(t))throw"Embed name must start with letter and be only letters and digits";D[t]=e},o=r.AbstractMathQuill=v(Q,(function(t){t.init=function(t){this.__controller=t,this.__options=t.options,this.id=t.id,this.data=t.data},t.__mathquillify=function(t){var e,n=this.__controller,i=n.root,r=n.container;n.createTextarea(),e=r.addClass(t).contents().detach(),i.jQ=q('<span class="mq-root-block"/>').attr(It,i.id).appendTo(r),this.latex(e.text()),this.revert=function(){return r.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(e)}},t.config=function(t){return i(this.__options,t),this},t.el=function(){return this.__controller.container[0]},t.text=function(){return this.__controller.exportText()},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexMath(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()},t.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},t.reflow=function(){return this.__controller.root.postOrder("reflow"),this}})),n.prototype=o.prototype,r.EditableField=v(o,(function(e,n){e.__mathquillify=function(){return n.__mathquillify.apply(this,arguments),this.__controller.editable=!0,this.__controller.delegateMouseEvents(),this.__controller.editablesTextareaEvents(),this},e.focus=function(){return this.__controller.textarea.focus(),this},e.blur=function(){return this.__controller.textarea.blur(),this},e.write=function(t){return this.__controller.writeLatex(t),this.__controller.scrollHoriz(),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this},e.empty=function(){var t=this.__controller.root,e=this.__controller.cursor;return t.eachChild("postOrder","dispose"),t.ends[y]=t.ends[w]=0,t.jQ.empty(),delete e.selection,e.insAtRightEnd(t),this},e.cmd=function(t){var e,n=this.__controller.notify(),i=n.cursor;return/^\\[a-z]+$/i.test(t)?(t=t.slice(1),(e=S[t]||mt[t])&&(t=e(t),i.selection&&t.replaces(i.replaceSelection()),t.createLeftOf(i.show()),this.__controller.scrollHoriz())):i.parent.write(i,t),n.blurred&&i.hide().parent.blur(),this},e.select=function(){var t=this.__controller;for(t.notify("move").cursor.insAtRightEnd(t.root);t.cursor[y];)t.selectLeft();return this},e.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},e.moveToDirEnd=function(t){return this.__controller.notify("move").cursor.insAtDirEnd(t,this.__controller.root),this},e.moveToLeftEnd=function(){return this.moveToDirEnd(y)},e.moveToRightEnd=function(){return this.moveToDirEnd(w)},e.keystroke=function(e){var n;for(e=e.replace(/^\s+|\s+$/g,"").split(/\s+/),n=0;n<e.length;n+=1)this.__controller.keystroke(e[n],{preventDefault:t});return this},e.typedText=function(t){for(var e=0;e<t.length;e+=1)this.__controller.typedText(t.charAt(e));return this},e.dropEmbedded=function(t,e,n){var i=t-q(window).scrollLeft(),r=e-q(window).scrollTop(),o=document.elementFromPoint(i,r);this.__controller.seek(q(o),t,e),pt().setOptions(n).createLeftOf(this.__controller.cursor)},e.clickAt=function(t,e,n){n=n||document.elementFromPoint(t,e);var i=this.__controller,r=i.root;return Lt.contains(r.jQ[0],n)||(n=r.jQ[0]),i.seek(q(n),t+pageXOffset,e+pageYOffset),i.blurred&&this.focus(),this},e.ignoreNextMousedown=function(t){return this.__controller.cursor.options.ignoreNextMousedown=t,this}})),n.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},n.EditableField.prototype=r.EditableField.prototype,_)!function(t,i){var o=r[t]=i(r);n[t]=function(i,r){var s,a=n(i);return a instanceof o||!i||!i.nodeType?a:((s=E(o.RootBlock(),q(i),z())).KIND_OF_MQ=t,o(s).__mathquillify(r,e))},n[t].prototype=o.prototype}(s,_[s]);return n}function u(t){var e,n="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf".split(" ");for(e=0;e<n.length;e+=1)!function(e){t[e]=function(t){this.controller.handle(e,t)}}(n[e]);t.reflow=function(){this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function f(t,e,n){return v(X,{ctrlSeq:t,htmlTemplate:"<"+e+" "+n+">&0</"+e+">"})}function h(t){var e=this.parent,n=t;do{if(n[w])return t.insLeftOf(e);n=n.parent.parent}while(n!==e);t.insRightOf(e)}function d(t,e){t.jQadd=function(){e.jQadd.apply(this,arguments),this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last")),this.contentjQ=this.jQ.children(":eq(1)")},t.reflow=function(){var t=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));K(this.delimjQs,Mt(1+.2*(t-1),1.2),1.2*t)}}function p(t,e){e=e||t;var n=ht[t],r=ht[e];j[t]=i(ft,y,t,n,e,r),j[n]=i(ft,w,t,n,e,r)}var m,b,g,v,y,w,q,x,k,O,S,j,C,T,E,_,z,A,Q,D,R,L,P,I,M,B,N,F,H,$,U,W,G,X,V,Z,J,K,Y,tt,et,nt,it,rt,ot,st,at,lt,ct,ut,ft,ht,dt,pt,mt,bt,gt,vt,yt,wt,qt,xt,kt,Ot,St,jt,Ct,Tt,Et,_t,zt,At,Qt,Dt,Rt,Lt=window.jQuery,Pt="mathquill-command-id",It="mathquill-block-id",Mt=Math.min,Bt=Math.max;if(!Lt)throw"MathQuill requires jQuery 1.5.2+ to be loaded first";for(nt in b=[].slice,g=e((function(t,n){return e((function(e,i){if(t in e)return e[t].apply(e,n.concat(i))}))})),v=function(t,e,n){function i(t){return"object"==typeof t}function r(t){return"function"==typeof t}function o(){}return function t(n,s){function a(){var t=new l;return r(t.init)&&t.init.apply(t,arguments),t}function l(){}var c,u,f;return void 0===s&&(s=n,n=Object),a.Bare=l,c=o.prototype=n.prototype,(u=l.prototype=a.prototype=a.p=new o).constructor=a,a.extend=function(e){return t(a,e)},(a.open=function(t){if(f={},r(t)?f=t.call(a,u,c,a,n):i(t)&&(f=t),i(f))for(var o in f)e.call(f,o)&&(u[o]=f[o]);return r(u.init)||(u.init=n),a})(s)}}(0,{}.hasOwnProperty),y=-1,w=1,q=v(Lt,(function(t){t.insDirOf=function(t,e){return t===y?this.insertBefore(e.first()):this.insertAfter(e.last())},t.insAtDirEnd=function(t,e){return t===y?this.prependTo(e):this.appendTo(e)}})),x=v((function(t){t.parent=0,t[y]=0,t[w]=0,t.init=function(t,e,n){this.parent=t,this[y]=e,this[w]=n},this.copy=function(t){return x(t.parent,t[y],t[w])}})),k=v((function(t){t[y]=0,t[w]=0,t.parent=0;var e=0;this.byId={},t.init=function(){this.id=e+=1,k.byId[this.id]=this,this.ends={},this.ends[y]=0,this.ends[w]=0},t.dispose=function(){delete k.byId[this.id]},t.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},t.jQ=q(),t.jQadd=function(t){return this.jQ=this.jQ.add(t)},t.jQize=function(t){function e(t){var n,i;for(t.getAttribute&&(n=t.getAttribute("mathquill-command-id"),i=t.getAttribute("mathquill-block-id"),n&&k.byId[n].jQadd(t),i&&k.byId[i].jQadd(t)),t=t.firstChild;t;t=t.nextSibling)e(t)}var n;for(t=q(t||this.html()),n=0;n<t.length;n+=1)e(t[n]);return t},t.createDir=function(t,e){o(t);var n=this;return n.jQize(),n.jQ.insDirOf(t,e.jQ),e[t]=n.adopt(e.parent,e[y],e[w]),n},t.createLeftOf=function(t){return this.createDir(y,t)},t.selectChildren=function(t,e){return T(t,e)},t.bubble=n((function(t){var e;for(e=this;e&&!1!==t(e);e=e.parent);return this})),t.postOrder=n((function(t){return function e(n){n.eachChild(e),t(n)}(this),this})),t.isEmpty=function(){return 0===this.ends[y]&&0===this.ends[w]},t.isStyleBlock=function(){return!1},t.children=function(){return O(this.ends[y],this.ends[w])},t.eachChild=function(){var t=this.children();return t.each.apply(t,arguments),this},t.foldChildren=function(t,e){return this.children().fold(t,e)},t.withDirAdopt=function(t,e,n,i){return O(this,this).withDirAdopt(t,e,n,i),this},t.adopt=function(t,e,n){return O(this,this).adopt(t,e,n),this},t.disown=function(){return O(this,this).disown(),this},t.remove=function(){return this.jQ.remove(),this.postOrder("dispose"),this.disown()}})),O=v((function(t){t.init=function(t,e,n){if(n===m&&(n=y),o(n),r("no half-empty fragments",!t==!e),this.ends={},t){r("withDir is passed to Fragment",t instanceof k),r("oppDir is passed to Fragment",e instanceof k),r("withDir and oppDir have the same parent",t.parent===e.parent),this.ends[n]=t,this.ends[-n]=e;var i=this.fold([],(function(t,e){return t.push.apply(t,e.jQ.get()),t}));this.jQ=this.jQ.add(i)}},t.jQ=q(),t.withDirAdopt=function(t,e,n,i){return t===y?this.adopt(e,n,i):this.adopt(e,i,n)},t.adopt=function(t,e,n){var i,r,o;return s(t,e,n),(i=this).disowned=!1,(r=i.ends[y])?(o=i.ends[w],e||(t.ends[y]=r),n?n[y]=o:t.ends[w]=o,i.ends[w][w]=n,i.each((function(n){n[y]=e,n.parent=t,e&&(e[w]=n),e=n})),i):this},t.disown=function(){var t,e,n=this,i=n.ends[y];return!i||n.disowned||(n.disowned=!0,t=n.ends[w],s(e=i.parent,i[y],i),s(e,t,t[w]),i[y]?i[y][w]=t[w]:e.ends[y]=t[w],t[w]?t[w][y]=i[y]:e.ends[w]=i[y]),n},t.remove=function(){return this.jQ.remove(),this.each("postOrder","dispose"),this.disown()},t.each=n((function(t){var e=this,n=e.ends[y];if(!n)return e;for(;n!==e.ends[w][w]&&!1!==t(n);n=n[w]);return e})),t.fold=function(t,e){return this.each((function(n){t=e.call(this,t,n)})),t}})),S={},j={},C=v(x,(function(t){t.init=function(t,e){this.parent=t,this.options=e;var n=this.jQ=this._jQ=q('<span class="mq-cursor">&#8203;</span>');this.blink=function(){n.toggleClass("mq-blink")},this.upDownCache={}},t.show=function(){return this.jQ=this._jQ.removeClass("mq-blink"),"intervalId"in this?clearInterval(this.intervalId):(this[w]?this.selection&&this.selection.ends[y][y]===this[y]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[w].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=q(),this},t.withDirInsertAt=function(t,e,n,i){var r=this.parent;this.parent=e,this[t]=n,this[-t]=i,r!==e&&r.blur&&r.blur(this)},t.insDirOf=function(t,e){return o(t),this.jQ.insDirOf(t,e.jQ),this.withDirInsertAt(t,e.parent,e[t],e),this.parent.jQ.addClass("mq-hasCursor"),this},t.insLeftOf=function(t){return this.insDirOf(y,t)},t.insRightOf=function(t){return this.insDirOf(w,t)},t.insAtDirEnd=function(t,e){return o(t),this.jQ.insAtDirEnd(t,e.jQ),this.withDirInsertAt(t,e,0,e.ends[t]),e.focus(),this},t.insAtLeftEnd=function(t){return this.insAtDirEnd(y,t)},t.insAtRightEnd=function(t){return this.insAtDirEnd(w,t)},t.jumpUpDown=function(t,e){var n,i,r=this;r.upDownCache[t.id]=x.copy(r),(n=r.upDownCache[e.id])?n[w]?r.insLeftOf(n[w]):r.insAtRightEnd(n.parent):(i=r.offset().left,e.seek(i,r))},t.offset=function(){var t=this.jQ.removeClass("mq-cursor").offset();return this.jQ.addClass("mq-cursor"),t},t.unwrapGramp=function(){var t=this.parent.parent,e=t.parent,n=t[w],i=t[y];if(t.disown().eachChild((function(r){r.isEmpty()||(r.children().adopt(e,i,n).each((function(e){e.jQ.insertBefore(t.jQ.first())})),i=r.ends[w])})),!this[w])if(this[y])this[w]=this[y][w];else for(;!this[w];){if(this.parent=this.parent[w],!this.parent){this[w]=t[w],this.parent=e;break}this[w]=this.parent.ends[y]}this[w]?this.insLeftOf(this[w]):this.insAtRightEnd(e),t.jQ.remove(),t[y].siblingDeleted&&t[y].siblingDeleted(this.options,w),t[w].siblingDeleted&&t[w].siblingDeleted(this.options,y)},t.startSelection=function(){var t,e=this.anticursor=x.copy(this),n=e.ancestors={};for(t=e;t.parent;t=t.parent)n[t.parent.id]=t},t.endSelection=function(){delete this.anticursor},t.select=function(){var t,e,n,i,o,s,a,l=this.anticursor;if(this[y]===l[y]&&this.parent===l.parent)return!1;for(t=this;t.parent;t=t.parent)if(t.parent.id in l.ancestors){e=t.parent;break}if(r("cursor and anticursor in the same tree",e),n=l.ancestors[e.id],s=w,t[y]!==n)for(a=t;a;a=a[w])if(a[w]===n[w]){s=y,i=t,o=n;break}return s===w&&(i=n,o=t),i instanceof x&&(i=i[w]),o instanceof x&&(o=o[y]),this.hide().selection=e.selectChildren(i,o),this.insDirOf(s,this.selection.ends[s]),this.selectionChanged(),!0},t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},t.deleteSelection=function(){this.selection&&(this[y]=this.selection.ends[y][y],this[w]=this.selection.ends[w][w],this.selection.remove(),this.selectionChanged(),delete this.selection)},t.replaceSelection=function(){var t=this.selection;return t&&(this[y]=t.ends[y][y],this[w]=t.ends[w][w],delete this.selection),t}})),T=v(O,(function(t,e){t.init=function(){e.init.apply(this,arguments),this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()},t.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),e.adopt.apply(this,arguments)},t.clear=function(){return this.jQ.replaceWith(this.jQ[0].childNodes),this},t.join=function(t){return this.fold("",(function(e,n){return e+n[t]()}))}})),E=v((function(t){t.init=function(t,e,n){this.id=t.id,this.data={},this.root=t,this.container=e,this.options=n,t.controller=this,this.cursor=t.cursor=C(t,n)},t.handle=function(t,e){var n,i=this.options.handlers;i&&i.fns[t]&&(n=i.APIClasses[this.KIND_OF_MQ](this),e===y||e===w?i.fns[t](e,n):i.fns[t](n))};var e=[];this.onNotify=function(t){e.push(t)},t.notify=function(){for(var t=0;t<e.length;t+=1)e[t].apply(this.cursor,arguments);return this}})),_={},z=v(),A={},Q=v(),D={},l.prototype=Q.p,l.VERSION="v0.10.1",l.interfaceVersion=function(t){if(1!==t)throw"Only interface version 1 supported. You specified: "+t;return(a=function(){window.console&&console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')})(),l},l.getInterface=c,R=c.MIN=1,L=c.MAX=2,l.noConflict=function(){return window.MathQuill=P,l},P=window.MathQuill,window.MathQuill=l,I=function(){function e(t){var e,i=t.which||t.keyCode,r=n[i],o=[];return t.ctrlKey&&o.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&o.push("Meta"),t.altKey&&o.push("Alt"),t.shiftKey&&o.push("Shift"),e=r||String.fromCharCode(i),o.length||r?(o.push(e),o.join("-")):e}var n={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(n,i){function r(t){m=t,clearTimeout(c),c=setTimeout(t)}function o(e){r((function(n){m=t,clearTimeout(c),e(n)}))}function s(){i.keystroke(e(f),f)}function a(){if(!function(){var t=d[0];return"selectionStart"in t&&t.selectionStart!==t.selectionEnd}()){var t=d.val();1===t.length?(d.val(""),i.typedText(t)):t&&d[0].select&&d[0].select()}}function l(){var t=d.val();d.val(""),t&&i.paste(t)}var c,u,f=null,h=null,d=Lt(n),p=Lt(i.container||d),m=t;return p.bind("keydown keypress input keyup focusout paste",(function(t){m(t)})),u=!1,p.bind({keydown:function(t){f=t,h=null,u&&o((function(t){t&&"focusout"===t.type||!d[0].select||d[0].select()})),s()},keypress:function(t){f&&h&&s(),h=t,r(a)},keyup:function(t){f&&!h&&r(a)},focusout:function(){f=h=null},cut:function(){o((function(){i.cut()}))},copy:function(){o((function(){i.copy()}))},paste:function(t){d.focus(),r(l)}}),{select:function(e){m(),m=t,clearTimeout(c),d.val(e),e&&d[0].select&&d[0].select(),u=!!e}}}}(),M=v((function(t,e,n){function i(t,e){throw"Parse Error: "+e+" at "+(t=t?"'"+t+"'":"EOF")}var o,s,a;t.init=function(t){this._=t},t.parse=function(t){return this.skip(a)._(""+t,(function(t,e){return e}),i)},t.or=function(t){r("or is passed a parser",t instanceof n);var e=this;return n((function(n,i,r){return e._(n,i,(function(e){return t._(n,i,r)}))}))},t.then=function(t){var e=this;return n((function(i,o,s){return e._(i,(function(e,i){var a=t instanceof n?t:t(i);return r("a parser is returned",a instanceof n),a._(e,o,s)}),s)}))},t.many=function(){var t=this;return n((function(e,n,i){function r(t,n){return e=t,s.push(n),!0}function o(){return!1}for(var s=[];t._(e,r,o););return n(e,s)}))},t.times=function(t,e){arguments.length<2&&(e=t);var i=this;return n((function(n,r,o){function s(t,e){return f.push(e),n=t,!0}function a(t,e){return c=e,n=t,!1}function l(t,e){return!1}var c,u,f=[],h=!0;for(u=0;u<t;u+=1)if(!(h=i._(n,s,a)))return o(n,c);for(;u<e&&h;u+=1)h=i._(n,s,l);return r(n,f)}))},t.result=function(t){return this.then(s(t))},t.atMost=function(t){return this.times(0,t)},t.atLeast=function(t){var e=this;return e.times(t).then((function(t){return e.many().map((function(e){return t.concat(e)}))}))},t.map=function(t){return this.then((function(e){return s(t(e))}))},t.skip=function(t){return this.then((function(e){return t.result(e)}))},this.string=function(t){var e=t.length,i="expected '"+t+"'";return n((function(n,r,o){var s=n.slice(0,e);return s===t?r(n.slice(e),s):o(n,i)}))},o=this.regex=function(t){r("regexp parser is anchored","^"===t.toString().charAt(1));var e="expected "+t;return n((function(n,i,r){var o,s=t.exec(n);return s?(o=s[0],i(n.slice(o.length),o)):r(n,e)}))},s=n.succeed=function(t){return n((function(e,n){return n(e,t)}))},n.fail=function(t){return n((function(e,n,i){return i(e,t)}))},n.letter=o(/^[a-z]/i),n.letters=o(/^[a-z]*/i),n.digit=o(/^[0-9]/),n.digits=o(/^[0-9]*/),n.whitespace=o(/^\s+/),n.optWhitespace=o(/^\s*/),n.any=n((function(t,e,n){return t?e(t.slice(1),t.charAt(0)):n(t,"expected any character")})),n.all=n((function(t,e,n){return e("",t)})),a=n.eof=n((function(t,e,n){return t?n(t,"expected EOF"):e(t,t)}))})),B=function(){function t(t){var e,n=t[0]||W();for(e=1;e<t.length;e+=1)t[e].children().adopt(n,n.ends[w],0);return n}var e=M.string,n=M.regex,i=M.letter,r=M.any,o=M.optWhitespace,s=M.succeed,a=M.fail,l=i.map((function(t){return qt(t)})),c=n(/^[^${}\\_^]/).map((function(t){return $(t)})),u=n(/^[^\\a-eg-zA-Z]/).or(e("\\").then(n(/^[a-z]+/i).or(n(/^\s+/).result(" ")).or(r))).then((function(t){var e=S[t];return e?e(t).parser():a("unknown command: \\"+t)})),f=u.or(l).or(c),h=e("{").then((function(){return p})).skip(e("}")),d=o.then(h.or(f.map((function(t){var e=W();return t.adopt(e,0,0),e})))),p=d.many().map(t).skip(o),m=e("[").then(d.then((function(t){return"]"!==t.join("latex")?s(t):a()})).many().map(t).skip(o)).skip(e("]")),b=p;return b.block=d,b.optBlock=m,b}(),E.open((function(t,e){t.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},t.writeLatex=function(t){var e=this.notify("edit").cursor,n=M.all,i=M.eof,r=B.skip(i).or(n.result(!1)).parse(t);return r&&!r.isEmpty()&&(r.children().adopt(e.parent,e[y],e[w]),r.jQize().insertBefore(e.jQ),e[y]=r.ends[w],r.finalizeInsert(e.options,e),r.ends[w][w].siblingCreated&&r.ends[w][w].siblingCreated(e.options,y),r.ends[y][y].siblingCreated&&r.ends[y][y].siblingCreated(e.options,w),e.parent.bubble("reflow")),this},t.renderLatexMath=function(t){var e,n,i=this.root,r=this.cursor,o=M.all,s=M.eof,a=B.skip(s).or(o.result(!1)).parse(t);i.eachChild("postOrder","dispose"),i.ends[y]=i.ends[w]=0,a&&a.children().adopt(i,0,0),e=i.jQ,a?(n=a.join("html"),e.html(n),i.jQize(e.children()),i.finalizeInsert(r.options)):e.empty(),delete r.selection,r.insAtRightEnd(i)},t.renderLatexText=function(t){var e,n,i,r,o,s,a,l,c=this.root,u=this.cursor;if(c.jQ.children().slice(1).remove(),c.eachChild("postOrder","dispose"),c.ends[y]=c.ends[w]=0,delete u.selection,u.show().insAtRightEnd(c),e=M.regex,n=M.string,i=M.eof,r=M.all,o=n("$").then(B).skip(n("$").or(i)).map((function(t){var e,n=Z(u);return n.createBlocks(),e=n.ends[y],t.children().adopt(e,0,0),n})),s=n("\\$").result("$").or(e(/^[^$]/)).map($),a=o.or(s).many().skip(i).or(r.result(!1)).parse(t)){for(l=0;l<a.length;l+=1)a[l].adopt(c,c.ends[w],0);c.jQize().appendTo(c.jQ),c.finalizeInsert(u.options)}}})),E.open((function(t){t.focusBlurEvents=function(){function t(){clearTimeout(n),o.selection&&o.selection.jQ.addClass("mq-blur"),e()}function e(){o.hide().parent.blur(),i.container.removeClass("mq-focused"),q(window).unbind("blur",t)}var n,i=this,r=i.root,o=i.cursor;i.textarea.focus((function(){i.blurred=!1,clearTimeout(n),i.container.addClass("mq-focused"),o.parent||o.insAtRightEnd(r),o.selection?(o.selection.jQ.removeClass("mq-blur"),i.selectionChanged()):o.show()})).blur((function(){i.blurred=!0,n=setTimeout((function(){r.postOrder("intentionalBlur"),o.clearSelection().endSelection(),e()})),q(window).bind("blur",t)})),i.blurred=!0,o.hide().parent.blur()}})),E.open((function(t,e){t.exportText=function(){return this.root.foldChildren("",(function(t,e){return t+e.text()}))}})),E.open((function(t){t.keystroke=function(t,e){this.cursor.parent.keystroke(t,e,this)}})),k.open((function(t){t.keystroke=function(t,e,n){var i=n.cursor;switch(t){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":n.ctrlDeleteDir(y);break;case"Shift-Backspace":case"Backspace":n.backspace();break;case"Esc":case"Tab":return void n.escapeDir(w,t,e);case"Shift-Tab":case"Shift-Esc":return void n.escapeDir(y,t,e);case"End":n.notify("move").cursor.insAtRightEnd(i.parent);break;case"Ctrl-End":n.notify("move").cursor.insAtRightEnd(n.root);break;case"Shift-End":for(;i[w];)n.selectRight();break;case"Ctrl-Shift-End":for(;i[w]||i.parent!==n.root;)n.selectRight();break;case"Home":n.notify("move").cursor.insAtLeftEnd(i.parent);break;case"Ctrl-Home":n.notify("move").cursor.insAtLeftEnd(n.root);break;case"Shift-Home":for(;i[y];)n.selectLeft();break;case"Ctrl-Shift-Home":for(;i[y]||i.parent!==n.root;)n.selectLeft();break;case"Left":n.moveLeft();break;case"Shift-Left":n.selectLeft();break;case"Ctrl-Left":break;case"Right":n.moveRight();break;case"Shift-Right":n.selectRight();break;case"Ctrl-Right":break;case"Up":n.moveUp();break;case"Down":n.moveDown();break;case"Shift-Up":if(i[y])for(;i[y];)n.selectLeft();else n.selectLeft();case"Shift-Down":if(i[w])for(;i[w];)n.selectRight();else n.selectRight();case"Ctrl-Up":case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":n.ctrlDeleteDir(w);break;case"Shift-Del":case"Del":n.deleteForward();break;case"Meta-A":case"Ctrl-A":for(n.notify("move").cursor.insAtRightEnd(n.root);i[y];)n.selectLeft();break;default:return}e.preventDefault(),n.scrollHoriz()},t.moveOutOf=t.moveTowards=t.deleteOutOf=t.deleteTowards=t.unselectInto=t.selectOutOf=t.selectTowards=function(){r("overridden or never called on this node")}})),E.open((function(t){function e(t,e){var n=t.notify("upDown").cursor,i=e+"Into",r=e+"OutOf";return n[w][i]?n.insAtLeftEnd(n[w][i]):n[y][i]?n.insAtRightEnd(n[y][i]):n.parent.bubble((function(t){var e=t[r];if(e&&("function"==typeof e&&(e=t[r](n)),e instanceof k&&n.jumpUpDown(t,e),!0!==e))return!1})),t}this.onNotify((function(t){"move"!==t&&"upDown"!==t||this.show().clearSelection()})),t.escapeDir=function(t,e,n){o(t);var i=this.cursor;if(i.parent!==this.root&&n.preventDefault(),i.parent!==this.root)return i.parent.moveOutOf(t,i),this.notify("move")},A.leftRightIntoCmdGoes=function(t){if(t&&"up"!==t&&"down"!==t)throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+t+'"';return t},t.moveDir=function(t){o(t);var e=this.cursor,n=e.options.leftRightIntoCmdGoes;return e.selection?e.insDirOf(t,e.selection.ends[t]):e[t]?e[t].moveTowards(t,e,n):e.parent.moveOutOf(t,e,n),this.notify("move")},t.moveLeft=function(){return this.moveDir(y)},t.moveRight=function(){return this.moveDir(w)},t.moveUp=function(){return e(this,"up")},t.moveDown=function(){return e(this,"down")},this.onNotify((function(t){"upDown"!==t&&(this.upDownCache={})})),this.onNotify((function(t){"edit"===t&&this.show().deleteSelection()})),t.deleteDir=function(t){var e,n;return o(t),n=(e=this.cursor).selection,this.notify("edit"),n||(e[t]?e[t].deleteTowards(t,e):e.parent.deleteOutOf(t,e)),e[y].siblingDeleted&&e[y].siblingDeleted(e.options,w),e[w].siblingDeleted&&e[w].siblingDeleted(e.options,y),e.parent.bubble("reflow"),this},t.ctrlDeleteDir=function(t){o(t);var e=this.cursor;return!e[t]||e.selection?this.deleteDir(t):(this.notify("edit"),t===y?O(e.parent.ends[y],e[y]).remove():O(e[w],e.parent.ends[w]).remove(),e.insAtDirEnd(t,e.parent),e[y].siblingDeleted&&e[y].siblingDeleted(e.options,w),e[w].siblingDeleted&&e[w].siblingDeleted(e.options,y),e.parent.bubble("reflow"),this)},t.backspace=function(){return this.deleteDir(y)},t.deleteForward=function(){return this.deleteDir(w)},this.onNotify((function(t){"select"!==t&&this.endSelection()})),t.selectDir=function(t){var e,n=this.notify("select").cursor,i=n.selection;o(t),n.anticursor||n.startSelection(),(e=n[t])?i&&i.ends[t]===e&&n.anticursor[-t]!==e?e.unselectInto(t,n):e.selectTowards(t,n):n.parent.selectOutOf(t,n),n.clearSelection(),n.select()||n.show()},t.selectLeft=function(){return this.selectDir(y)},t.selectRight=function(){return this.selectDir(w)}})),E.open((function(t){z.p.substituteTextarea=function(){return q("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true />")[0]},t.createTextarea=function(){var t,e=this.textareaSpan=q('<span class="mq-textarea"></span>'),n=this.options.substituteTextarea();if(!n.nodeType)throw"substituteTextarea() must return a DOM element, got "+n;n=this.textarea=q(n).appendTo(e),(t=this).cursor.selectionChanged=function(){t.selectionChanged()}},t.selectionChanged=function(){var t=this;Y(t.container[0]),t.textareaSelectionTimeout===m&&(t.textareaSelectionTimeout=setTimeout((function(){t.setTextareaSelection()})))},t.setTextareaSelection=function(){this.textareaSelectionTimeout=m;var t="";this.cursor.selection&&(t=this.cursor.selection.join("latex"),this.options.statelessClipboard&&(t="$"+t+"$")),this.selectFn(t)},t.staticMathTextareaEvents=function(){function t(){r.detach(),e.blurred=!0}var e=this,n=(e.root,e.cursor),i=e.textarea,r=e.textareaSpan;this.container.prepend(Lt('<span class="mq-selectable">').text("$"+e.exportLatex()+"$")),e.blurred=!0,i.bind("cut paste",!1).bind("copy",(function(){e.setTextareaSelection()})).focus((function(){e.blurred=!1})).blur((function(){n.selection&&n.selection.clear(),setTimeout(t)})),e.selectFn=function(t){i.val(t),t&&i.select()}},z.p.substituteKeyboardEvents=I,t.editablesTextareaEvents=function(){var t=this.textarea,e=this.textareaSpan,n=this.options.substituteKeyboardEvents(t,this);this.selectFn=function(t){n.select(t)},this.container.prepend(e),this.focusBlurEvents()},t.typedText=function(t){if("\n"===t)return this.handle("enter");var e=this.notify().cursor;e.parent.write(e,t),this.scrollHoriz()},t.cut=function(){var t=this,e=t.cursor;e.selection&&setTimeout((function(){t.notify("edit"),e.parent.bubble("reflow")}))},t.copy=function(){this.setTextareaSelection()},t.paste=function(t){this.options.statelessClipboard&&(t="$"===t.slice(0,1)&&"$"===t.slice(-1)?t.slice(1,-1):"\\text{"+t+"}"),this.writeLatex(t).cursor.show()}})),E.open((function(e){z.p.ignoreNextMousedown=t,e.delegateMouseEvents=function(){var e=this.root.jQ;this.container.bind("mousedown.mathquill",(function(n){function i(t){o=q(t.target)}function r(t){l.anticursor||l.startSelection(),a.seek(o,t.pageX,t.pageY).cursor.select(),o=m}var o,s=q(n.target).closest(".mq-root-block"),a=k.byId[s.attr(It)||e.attr(It)].controller,l=a.cursor,c=l.blink,u=a.textareaSpan,f=a.textarea;n.preventDefault(),n.target.unselectable=!0,l.options.ignoreNextMousedown(n)||(l.options.ignoreNextMousedown=t,a.blurred&&(a.editable||s.prepend(u),f.focus()),l.blink=t,a.seek(q(n.target),n.pageX,n.pageY).cursor.startSelection(),s.mousemove(i),q(n.target.ownerDocument).mousemove(r).mouseup((function t(e){l.blink=c,l.selection||(a.editable?l.show():u.detach()),s.unbind("mousemove",i),q(e.target.ownerDocument).unbind("mousemove",r).unbind("mouseup",t)})))}))}})),E.open((function(t){t.seek=function(t,e,n){var i,o,s,a=this.notify("select").cursor;return t&&((i=t.attr(It)||t.attr(Pt))||(i=(o=t.parent()).attr(It)||o.attr(Pt))),r("nodeId is the id of some Node that exists",s=i?k.byId[i]:this.root),a.clearSelection().show(),s.seek(e,a),this.scrollHoriz(),this}})),E.open((function(t){t.scrollHoriz=function(){var t,e,n,i,r,o=this.cursor,s=o.selection,a=this.root.jQ[0].getBoundingClientRect();if(s)if(i=(n=s.jQ[0].getBoundingClientRect()).left-(a.left+20),r=n.right-(a.right-20),s.ends[y]===o[w])if(i<0)e=i;else{if(!(r>0))return;e=n.left-r<a.left+20?i:r}else if(r>0)e=r;else{if(!(i<0))return;e=n.right-i>a.right-20?r:i}else if((t=o.jQ[0].getBoundingClientRect().left)>a.right-20)e=t-(a.right-20);else{if(!(t<a.left+20))return;e=t-(a.left+20)}this.root.jQ.stop().animate({scrollLeft:"+="+e},100)}})),N=v(k,(function(t,e){t.finalizeInsert=function(t,e){var n=this;n.postOrder("finalizeTree",t),n.postOrder("contactWeld",e),n.postOrder("blur"),n.postOrder("reflow"),n[w].siblingCreated&&n[w].siblingCreated(t,y),n[y].siblingCreated&&n[y].siblingCreated(t,w),n.bubble("reflow")}})),F=v(N,(function(t,e){t.init=function(t,n,i){var r=this;e.init.call(r),r.ctrlSeq||(r.ctrlSeq=t),n&&(r.htmlTemplate=n),i&&(r.textTemplate=i)},t.replaces=function(t){t.disown(),this.replacedFragment=t},t.isEmpty=function(){return this.foldChildren(!0,(function(t,e){return t&&e.isEmpty()}))},t.parser=function(){var t=B.block,e=this;return t.times(e.numBlocks()).map((function(t){e.blocks=t;for(var n=0;n<t.length;n+=1)t[n].adopt(e,e.ends[w],0);return e}))},t.createLeftOf=function(t){var n=this,i=n.replacedFragment;n.createBlocks(),e.createLeftOf.call(n,t),i&&(i.adopt(n.ends[y],0,0),i.jQ.appendTo(n.ends[y].jQ)),n.finalizeInsert(t.options),n.placeCursor(t)},t.createBlocks=function(){var t,e=this,n=e.numBlocks(),i=e.blocks=Array(n);for(t=0;t<n;t+=1)(i[t]=W()).adopt(e,e.ends[w],0)},t.placeCursor=function(t){t.insAtRightEnd(this.foldChildren(this.ends[y],(function(t,e){return t.isEmpty()?t:e})))},t.moveTowards=function(t,e,n){var i=n&&this[n+"Into"];e.insAtDirEnd(-t,i||this.ends[-t])},t.deleteTowards=function(t,e){this.isEmpty()?e[t]=this.remove()[t]:this.moveTowards(t,e,null)},t.selectTowards=function(t,e){e[-t]=this,e[t]=this[t]},t.selectChildren=function(){return T(this,this)},t.unselectInto=function(t,e){e.insAtDirEnd(-t,e.anticursor.ancestors[this.id])},t.seek=function(t,e){function n(t){var e={};return e[y]=t.jQ.offset().left,e[w]=e[y]+t.jQ.outerWidth(),e}var i,r=this,o=n(r);return t<o[y]?e.insLeftOf(r):t>o[w]?e.insRightOf(r):(i=o[y],void r.eachChild((function(s){var a=n(s);return t<a[y]?(t-i<a[y]-t?s[y]?e.insAtRightEnd(s[y]):e.insLeftOf(r):e.insAtLeftEnd(s),!1):t>a[w]?void(s[w]?i=a[w]:o[w]-t<t-a[w]?e.insRightOf(r):e.insAtRightEnd(s)):(s.seek(t,e),!1)})))},t.numBlocks=function(){var t=this.htmlTemplate.match(/&\d+/g);return t?t.length:0},t.html=function(){var t,e,n,i=this,o=i.blocks,s=" mathquill-command-id="+i.id,a=i.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);for(r("no unmatched angle brackets",a.join("")===this.htmlTemplate),t=0,e=a[0];e;e=a[t+=1])if("/>"===e.slice(-2))a[t]=e.slice(0,-2)+s+"/>";else if("<"===e.charAt(0)){r("not an unmatched top-level close tag","/"!==e.charAt(1)),a[t]=e.slice(0,-1)+s+">",n=1;do{r("no missing close tags",e=a[t+=1]),"</"===e.slice(0,2)?n-=1:"<"===e.charAt(0)&&"/>"!==e.slice(-2)&&(n+=1)}while(n>0)}return a.join("").replace(/>&(\d+)/g,(function(t,e){return" mathquill-block-id="+o[e].id+">"+o[e].join("html")}))},t.latex=function(){return this.foldChildren(this.ctrlSeq,(function(t,e){return t+"{"+(e.latex()||" ")+"}"}))},t.textTemplate=[""],t.text=function(){var t=this,e=0;return t.foldChildren(t.textTemplate[e],(function(n,i){e+=1;var r=i.text();return n&&"("===t.textTemplate[e]&&"("===r[0]&&")"===r.slice(-1)?n+r.slice(1,-1)+t.textTemplate[e]:n+i.text()+(t.textTemplate[e]||"")}))}})),H=v(F,(function(e,n){e.init=function(t,e,i){i||(i=t&&t.length>1?t.slice(1):t),n.init.call(this,t,e,[i])},e.parser=function(){return M.succeed(this)},e.numBlocks=function(){return 0},e.replaces=function(t){t.remove()},e.createBlocks=t,e.moveTowards=function(t,e){e.jQ.insDirOf(t,this.jQ),e[-t]=this,e[t]=this[t]},e.deleteTowards=function(t,e){e[t]=this.remove()[t]},e.seek=function(t,e){t-this.jQ.offset().left<this.jQ.outerWidth()/2?e.insLeftOf(this):e.insRightOf(this)},e.latex=function(){return this.ctrlSeq},e.text=function(){return this.textTemplate},e.placeCursor=t,e.isEmpty=function(){return!0}})),$=v(H,(function(t,e){t.init=function(t,n){e.init.call(this,t,"<span>"+(n||t)+"</span>")}})),U=v(H,(function(t,e){t.init=function(t,n,i){e.init.call(this,t,'<span class="mq-binary-operator">'+n+"</span>",i)}})),W=v(N,(function(t,e){t.join=function(t){return this.foldChildren("",(function(e,n){return e+n[t]()}))},t.html=function(){return this.join("html")},t.latex=function(){return this.join("latex")},t.text=function(){return this.ends[y]===this.ends[w]&&0!==this.ends[y]?this.ends[y].text():this.join("text")},t.keystroke=function(t,n,i){return!i.options.spaceBehavesLikeTab||"Spacebar"!==t&&"Shift-Spacebar"!==t?e.keystroke.apply(this,arguments):(n.preventDefault(),void i.escapeDir("Shift-Spacebar"===t?y:w,t,n))},t.moveOutOf=function(t,e,n){n&&this.parent[n+"Into"]||!this[t]?e.insDirOf(t,this.parent):e.insAtDirEnd(-t,this[t])},t.selectOutOf=function(t,e){e.insDirOf(t,this.parent)},t.deleteOutOf=function(t,e){e.unwrapGramp()},t.seek=function(t,e){var n=this.ends[w];if(!n||n.jQ.offset().left+n.jQ.outerWidth()<t)return e.insAtRightEnd(this);if(t<this.ends[y].jQ.offset().left)return e.insAtLeftEnd(this);for(;t<n.jQ.offset().left;)n=n[y];return n.seek(t,e)},t.chToCmd=function(t,e){var n;return t.match(/^[a-eg-zA-Z]$/)?qt(t):/^\d$/.test(t)?yt(t):e&&e.typingSlashWritesDivisionSymbol&&"/"===t?S["÷"](t):e&&e.typingAsteriskWritesTimesSymbol&&"*"===t?S["×"](t):(n=j[t]||S[t])?n(t):$(t)},t.write=function(t,e){var n=this.chToCmd(e,t.options);t.selection&&n.replaces(t.replaceSelection()),n.createLeftOf(t.show())},t.focus=function(){return this.jQ.addClass("mq-hasCursor"),this.jQ.removeClass("mq-empty"),this},t.blur=function(){return this.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.jQ.addClass("mq-empty"),this}})),_.StaticMath=function(t){return v(t.AbstractMathQuill,(function(e,n){this.RootBlock=W,e.__mathquillify=function(t,e){return this.config(t),n.__mathquillify.call(this,"mq-math-mode"),this.__controller.delegateMouseEvents(),this.__controller.staticMathTextareaEvents(),this},e.init=function(){n.init.apply(this,arguments),this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField)},e.latex=function(){var e=n.latex.apply(this,arguments);return arguments.length>0&&this.__controller.root.postOrder("registerInnerField",this.innerFields=[],t.MathField),e}}))},G=v(W,u),_.MathField=function(e){return v(e.EditableField,(function(e,n){this.RootBlock=G,e.__mathquillify=function(e,i){return this.config(e),i>1&&(this.__controller.root.reflow=t),n.__mathquillify.call(this,"mq-editable-field mq-math-mode"),delete this.__controller.root.reflow,this}}))},X=v(k,(function(t,e){function n(t){var e,n;if(t.jQ[0].normalize(),e=t.jQ[0].firstChild)return r("only node in TextBlock span is Text node",3===e.nodeType),(n=V(e.data)).jQadd(e),t.children().disown(),n.adopt(t,0,0)}t.ctrlSeq="\\text",t.replaces=function(t){t instanceof O?this.replacedText=t.remove().jQ.text():"string"==typeof t&&(this.replacedText=t)},t.jQadd=function(t){e.jQadd.call(this,t),this.ends[y]&&this.ends[y].jQadd(this.jQ[0].firstChild)},t.createLeftOf=function(t){var n,i=this;if(e.createLeftOf.call(this,t),i[w].siblingCreated&&i[w].siblingCreated(t.options,y),i[y].siblingCreated&&i[y].siblingCreated(t.options,w),i.bubble("reflow"),t.insAtRightEnd(i),i.replacedText)for(n=0;n<i.replacedText.length;n+=1)i.write(t,i.replacedText.charAt(n))},t.parser=function(){var t=this,e=M.string,n=M.regex;return M.optWhitespace.then(e("{")).then(n(/^[^}]*/)).skip(e("}")).map((function(e){return 0===e.length?O():(V(e).adopt(t,0,0),t)}))},t.textContents=function(){return this.foldChildren("",(function(t,e){return t+e.text}))},t.text=function(){return'"'+this.textContents()+'"'},t.latex=function(){var t=this.textContents();return 0===t.length?"":"\\text{"+t.replace(/\\/g,"\\backslash ").replace(/[{}]/g,"\\$&")+"}"},t.html=function(){return'<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>"},t.moveTowards=function(t,e){e.insAtDirEnd(-t,this)},t.moveOutOf=function(t,e){e.insDirOf(t,this)},t.unselectInto=t.moveTowards,t.selectTowards=F.prototype.selectTowards,t.deleteTowards=F.prototype.deleteTowards,t.selectOutOf=function(t,e){e.insDirOf(t,this)},t.deleteOutOf=function(t,e){this.isEmpty()&&e.insRightOf(this)},t.write=function(t,n){var i,r;t.show().deleteSelection(),"$"!==n?t[y]?t[y].appendText(n):V(n).createLeftOf(t):this.isEmpty()?(t.insRightOf(this),$("\\$","$").createLeftOf(t)):t[w]?t[y]?(i=X(),(r=this.ends[y]).disown().jQ.detach(),r.adopt(i,0,0),t.insLeftOf(this),e.createLeftOf.call(i,t)):t.insLeftOf(this):t.insRightOf(this)},t.seek=function(t,e){var i,r,o,s,a,l,c,u;for(e.hide(),i=n(this),r=this.jQ.width()/this.text.length,(o=Math.round((t-this.jQ.offset().left)/r))<=0?e.insAtLeftEnd(this):o>=i.text.length?e.insAtRightEnd(this):e.insLeftOf(i.splitRight(o)),l=a=(s=t-e.show().offset().left)&&s<0?y:w;e[a]&&s*l>0;)e[a].moveTowards(a,e),l=s,s=t-e.offset().left;a*s<-a*l&&e[-a].moveTowards(-a,e),e.anticursor?e.anticursor.parent===this&&(c=e[y]&&e[y].text.length,this.anticursorPosition===c?e.anticursor=x.copy(e):(this.anticursorPosition<c?(u=e[y].splitRight(this.anticursorPosition),e[y]=u):u=e[w].splitRight(this.anticursorPosition-c),e.anticursor=x(this,u[y],u))):this.anticursorPosition=e[y]&&e[y].text.length},t.blur=function(t){W.prototype.blur.call(this),t&&(""===this.textContents()?(this.remove(),t[y]===this?t[y]=this[y]:t[w]===this&&(t[w]=this[w])):n(this))},t.focus=W.prototype.focus})),V=v(k,(function(t,e){function n(t,e){return e.charAt(t===y?0:-1+e.length)}t.init=function(t){e.init.call(this),this.text=t},t.jQadd=function(t){this.dom=t,this.jQ=q(t)},t.jQize=function(){return this.jQadd(document.createTextNode(this.text))},t.appendText=function(t){this.text+=t,this.dom.appendData(t)},t.prependText=function(t){this.text=t+this.text,this.dom.insertData(0,t)},t.insTextAtDirEnd=function(t,e){o(e),e===w?this.appendText(t):this.prependText(t)},t.splitRight=function(t){var e=V(this.text.slice(t)).adopt(this.parent,this,this[w]);return e.jQadd(this.dom.splitText(t)),this.text=this.text.slice(0,t),e},t.moveTowards=function(t,e){var i,r;return o(t),i=n(-t,this.text),(r=this[-t])?r.insTextAtDirEnd(i,t):V(i).createDir(-t,e),this.deleteTowards(t,e)},t.latex=function(){return this.text},t.deleteTowards=function(t,e){this.text.length>1?t===w?(this.dom.deleteData(0,1),this.text=this.text.slice(1)):(this.dom.deleteData(-1+this.text.length,1),this.text=this.text.slice(0,-1)):(this.remove(),this.jQ.remove(),e[t]=this[t])},t.selectTowards=function(t,e){var i,r,s,a;return o(t),i=e.anticursor,r=n(-t,this.text),i[t]===this?(s=V(r).createDir(t,e),i[t]=s,e.insDirOf(t,s)):((a=this[-t])?a.insTextAtDirEnd(r,t):(s=V(r).createDir(-t,e)).jQ.insDirOf(-t,e.selection.jQ),1===this.text.length&&i[-t]===this&&(i[-t]=this[-t])),this.deleteTowards(t,e)}})),S.text=S.textnormal=S.textrm=S.textup=S.textmd=X,S.em=S.italic=S.italics=S.emph=S.textit=S.textsl=f("\\textit","i",'class="mq-text-mode"'),S.strong=S.bold=S.textbf=f("\\textbf","b",'class="mq-text-mode"'),S.sf=S.textsf=f("\\textsf","span",'class="mq-sans-serif mq-text-mode"'),S.tt=S.texttt=f("\\texttt","span",'class="mq-monospace mq-text-mode"'),S.textsc=f("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"'),S.uppercase=f("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"'),S.lowercase=f("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"'),Z=v(F,(function(t,e){t.init=function(t){e.init.call(this,"$"),this.cursor=t},t.htmlTemplate='<span class="mq-math-mode">&0</span>',t.createBlocks=function(){e.createBlocks.call(this),this.ends[y].cursor=this.cursor,this.ends[y].write=function(t,e){"$"!==e?W.prototype.write.call(this,t,e):this.isEmpty()?(t.insRightOf(this.parent),this.parent.deleteTowards(dir,t),$("\\$","$").createLeftOf(t.show())):t[w]?t[y]?W.prototype.write.call(this,t,e):t.insLeftOf(this.parent):t.insRightOf(this.parent)}},t.latex=function(){return"$"+this.ends[y].latex()+"$"}})),J=v(G,(function(t,e){t.keystroke=function(t){if("Spacebar"!==t&&"Shift-Spacebar"!==t)return e.keystroke.apply(this,arguments)},t.write=function(t,e){var n;(t.show().deleteSelection(),"$"===e)?Z(t).createLeftOf(t):("<"===e?n="&lt;":">"===e&&(n="&gt;"),$(e,n).createLeftOf(t))}})),_.TextField=function(t){return v(t.EditableField,(function(t,e){this.RootBlock=J,t.__mathquillify=function(){return e.__mathquillify.call(this,"mq-editable-field mq-text-mode")},t.latex=function(t){return arguments.length>0?(this.__controller.renderLatexText(t),this.__controller.blurred&&this.__controller.cursor.hide().parent.blur(),this):this.__controller.exportLatex()}}))},j["\\"]=v(F,(function(t,e){t.ctrlSeq="\\",t.replaces=function(t){this._replacedFragment=t.disown(),this.isEmpty=function(){return!1}},t.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>',t.textTemplate=["\\"],t.createBlocks=function(){e.createBlocks.call(this),this.ends[y].focus=function(){return this.parent.jQ.addClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("mq-empty"),this},this.ends[y].blur=function(){return this.parent.jQ.removeClass("mq-hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("mq-empty"),this},this.ends[y].write=function(t,e){t.show().deleteSelection(),e.match(/[a-z]/i)?$(e).createLeftOf(t):(this.parent.renderCommand(t),"\\"===e&&this.isEmpty()||t.parent.write(t,e))},this.ends[y].keystroke=function(t,n,i){return"Tab"===t||"Enter"===t||"Spacebar"===t?(this.parent.renderCommand(i.cursor),void n.preventDefault()):e.keystroke.apply(this,arguments)}},t.createLeftOf=function(t){if(e.createLeftOf.call(this,t),this._replacedFragment){var n=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",(function(t){return q(t.target=n).trigger(t),!1})).insertBefore(this.jQ).add(this.jQ)}},t.latex=function(){return"\\"+this.ends[y].latex()+" "},t.renderCommand=function(t){var e,n;this.jQ=this.jQ.last(),this.remove(),this[w]?t.insLeftOf(this[w]):t.insAtRightEnd(this.parent),(e=this.ends[y].latex())||(e=" "),(n=S[e]||mt[e])?(n=n(e),this._replacedFragment&&n.replaces(this._replacedFragment),n.createLeftOf(t)):((n=X()).replaces(e),n.createLeftOf(t),t.insRightOf(n),this._replacedFragment&&this._replacedFragment.remove())}})),Y=t,tt=document.createElement("div").style,{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(nt in tt){et=nt;break}for(jt in et?K=function(t,e,n){t.css(et,"scale("+e+","+n+")")}:"filter"in tt?(Y=function(t){t.className=t.className},K=function(t,e,n){function i(){t.css("marginRight",(r.width()-1)*(e-1)/e+"px")}var r,o;e/=1+(n-1)/2,t.css("fontSize",n+"em"),t.hasClass("mq-matrixed-container")||t.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>'),r=t.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+e+",SizingMethod='auto expand')"),i(),o=setInterval(i),q(window).load((function(){clearTimeout(o),i()}))}):K=function(t,e,n){t.css("fontSize",n+"em")},it=v(F,(function(t,e){t.init=function(t,n,i){e.init.call(this,t,"<"+n+" "+i+">&0</"+n+">")}})),S.mathrm=i(it,"\\mathrm","span",'class="mq-roman mq-font"'),S.mathit=i(it,"\\mathit","i",'class="mq-font"'),S.mathbf=i(it,"\\mathbf","b",'class="mq-font"'),S.mathsf=i(it,"\\mathsf","span",'class="mq-sans-serif mq-font"'),S.mathtt=i(it,"\\mathtt","span",'class="mq-monospace mq-font"'),S.underline=i(it,"\\underline","span",'class="mq-non-leaf mq-underline"'),S.overline=S.bar=i(it,"\\overline","span",'class="mq-non-leaf mq-overline"'),S.overrightarrow=i(it,"\\overrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-right"'),S.overleftarrow=i(it,"\\overleftarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-left"'),S.overleftrightarrow=i(it,"\\overleftrightarrow","span",'class="mq-non-leaf mq-overarrow mq-arrow-both"'),S.overarc=i(it,"\\overarc","span",'class="mq-non-leaf mq-overarc"'),S.dot=v(F,(function(t,e){t.init=function(){e.init.call(this,"\\dot",'<span class="mq-non-leaf"><span class="mq-dot-recurring-inner"><span class="mq-dot-recurring">&#x2d9;</span><span class="mq-empty-box">&0</span></span></span>')}})),S.textcolor=v(F,(function(t,e){t.setColor=function(t){this.color=t,this.htmlTemplate='<span class="mq-textcolor" style="color:'+t+'">&0</span>'},t.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"},t.parser=function(){var t=this,n=M.optWhitespace,i=M.string,r=M.regex;return n.then(i("{")).then(r(/^[#\w\s.,()%-]*/)).skip(i("}")).then((function(n){return t.setColor(n),e.parser.call(t)}))},t.isStyleBlock=function(){return!0}})),S.class=v(F,(function(t,e){t.parser=function(){var t=this,n=M.string,i=M.regex;return M.optWhitespace.then(n("{")).then(i(/^[-\w\s\\\xA0-\xFF]*/)).skip(n("}")).then((function(n){return t.cls=n||"",t.htmlTemplate='<span class="mq-class '+n+'">&0</span>',e.parser.call(t)}))},t.latex=function(){return"\\class{"+this.cls+"}{"+this.blocks[0].latex()+"}"},t.isStyleBlock=function(){return!0}})),rt=v(F,(function(t,e){t.ctrlSeq="_{...}^{...}",t.createLeftOf=function(t){if(this.replacedFragment||t[y]||!t.options.supSubsRequireOperand)return e.createLeftOf.apply(this,arguments)},t.contactWeld=function(t){var e,n,i,r,o,s;for(e=y;e;e=e===y&&w)if(this[e]instanceof rt){for(n="sub";n;n="sub"===n&&"sup")i=this[n],r=this[e][n],i&&(r?i.isEmpty()?s=x(r,0,r.ends[y]):(i.jQ.children().insAtDirEnd(-e,r.jQ),o=i.children().disown(),s=x(r,o.ends[w],r.ends[y]),e===y?o.adopt(r,r.ends[w],0):o.adopt(r,0,r.ends[y])):this[e].addBlock(i.disown()),this.placeCursor=function(t,n){return function(i){i.insAtDirEnd(-e,t||n)}}(r,i));this.remove(),t&&t[y]===this&&(e===w&&s?s[y]?t.insRightOf(s[y]):t.insAtLeftEnd(s.parent):t.insRightOf(this[e]));break}},z.p.charsThatBreakOutOfSupSub="",t.finalizeTree=function(){this.ends[y].write=function(t,e){if(t.options.autoSubscriptNumerals&&this===this.parent.sub){if("_"===e)return;var n=this.chToCmd(e,t.options);return n instanceof H?t.deleteSelection():t.clearSelection().insRightOf(this.parent),n.createLeftOf(t.show())}t[y]&&!t[w]&&!t.selection&&t.options.charsThatBreakOutOfSupSub.indexOf(e)>-1&&t.insRightOf(this.parent),W.p.write.apply(this,arguments)}},t.moveTowards=function(t,n,i){n.options.autoSubscriptNumerals&&!this.sup?n.insDirOf(t,this):e.moveTowards.apply(this,arguments)},t.deleteTowards=function(t,n){if(n.options.autoSubscriptNumerals&&this.sub){var i=this.sub.ends[-t];i instanceof H?i.remove():i&&i.deleteTowards(t,n.insAtDirEnd(-t,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(y,n.insAtLeftEnd(this.sub)),this.sup&&n.insDirOf(-t,this))}else e.deleteTowards.apply(this,arguments)},t.latex=function(){function t(t,e){var n=e&&e.latex();return e?t+(1===n.length?n:"{"+(n||" ")+"}"):""}return t("_",this.sub)+t("^",this.sup)},t.addBlock=function(t){"sub"===this.supsub?(this.sup=this.upInto=this.sub.upOutOf=t,t.adopt(this,this.sub,0).downOutOf=this.sub,t.jQ=q('<span class="mq-sup"/>').append(t.jQ.children()).attr(It,t.id).prependTo(this.jQ)):(this.sub=this.downInto=this.sup.downOutOf=t,t.adopt(this,0,this.sup).upOutOf=this.sup,t.jQ=q('<span class="mq-sub"></span>').append(t.jQ.children()).attr(It,t.id).appendTo(this.jQ.removeClass("mq-sup-only")),this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));for(var e=0;e<2;e+=1)!function(t,e,n,i){t[e].deleteOutOf=function(r,o){if(o.insDirOf(this[r]?-r:r,this.parent),!this.isEmpty()){var s=this.ends[r];this.children().disown().withDirAdopt(r,o.parent,o[r],o[-r]).jQ.insDirOf(-r,o.jQ),o[-r]=s}t.supsub=n,delete t[e],delete t[i+"Into"],t[n][i+"OutOf"]=h,delete t[n].deleteOutOf,"sub"===e&&q(t.jQ.addClass("mq-sup-only")[0].lastChild).remove(),this.remove()}}(this,"sub sup".split(" ")[e],"sup sub".split(" ")[e],"down up".split(" ")[e])}})),S.subscript=S._=v(rt,(function(t,e){t.supsub="sub",t.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["_"],t.finalizeTree=function(){this.downInto=this.sub=this.ends[y],this.sub.upOutOf=h,e.finalizeTree.call(this)}})),S.superscript=S.supscript=S["^"]=v(rt,(function(t,e){t.supsub="sup",t.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>',t.textTemplate=["^"],t.finalizeTree=function(){this.upInto=this.sup=this.ends[w],this.sup.downOutOf=h,e.finalizeTree.call(this)},t.reflow=function(){var t=this.jQ,e=t.prev().innerHeight();e*=.6,t.css("vertical-align",e+"px")}})),ot=v(F,(function(t,e){t.init=function(t,e){var n='<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+e+'</big><span class="mq-from"><span>&0</span></span></span>';H.prototype.init.call(this,t,n)},t.createLeftOf=function(t){e.createLeftOf.apply(this,arguments),t.options.sumStartsWithNEquals&&(qt("n").createLeftOf(t),Qt().createLeftOf(t))},t.latex=function(){function t(t){return 1===t.length?t:"{"+(t||" ")+"}"}return this.ctrlSeq+"_"+t(this.ends[y].latex())+"^"+t(this.ends[w].latex())},t.parser=function(){var t,e=M.string,n=M.optWhitespace,i=M.succeed,r=B.block,o=this,s=o.blocks=[W(),W()];for(t=0;t<s.length;t+=1)s[t].adopt(o,o.ends[w],0);return n.then(e("_").or(e("^"))).then((function(t){var e=s["_"===t?0:1];return r.then((function(t){return t.children().adopt(e,e.ends[w],0),i(o)}))})).many().result(o)},t.finalizeTree=function(){this.downInto=this.ends[y],this.upInto=this.ends[w],this.ends[y].upOutOf=this.ends[w],this.ends[w].downOutOf=this.ends[y]}})),S["∑"]=S.sum=S.summation=i(ot,"\\sum ","&sum;"),S["∏"]=S.prod=S.product=i(ot,"\\prod ","&prod;"),S.coprod=S.coproduct=i(ot,"\\coprod ","&#8720;"),S["∫"]=S.int=S.integral=v(ot,(function(t,e){t.init=function(){H.prototype.init.call(this,"\\int ",'<span class="mq-int mq-non-leaf"><big>&int;</big><span class="mq-supsub mq-non-leaf"><span class="mq-sup"><span class="mq-sup-inner">&1</span></span><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&#8203</span></span></span>')},t.createLeftOf=F.p.createLeftOf})),st=S.frac=S.dfrac=S.cfrac=S.fraction=v(F,(function(t,e){t.ctrlSeq="\\frac",t.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',t.textTemplate=["(",")/(",")"],t.finalizeTree=function(){this.upInto=this.ends[w].upOutOf=this.ends[y],this.downInto=this.ends[y].downOutOf=this.ends[w]}})),at=S.over=j["/"]=v(st,(function(e,n){e.createLeftOf=function(e){if(!this.replacedFragment){for(var i=e[y];i&&!(i instanceof U||i instanceof(S.text||t)||i instanceof ot||"\\ "===i.ctrlSeq||/^[,;:]$/.test(i.ctrlSeq));)i=i[y];i instanceof ot&&i[w]instanceof rt&&((i=i[w])[w]instanceof rt&&i[w].ctrlSeq!=i.ctrlSeq&&(i=i[w])),i!==e[y]&&(this.replaces(O(i[w]||e.parent.ends[y],e[y])),e[y]=i)}n.createLeftOf.call(this,e)}})),lt=S.sqrt=S["√"]=v(F,(function(t,e){t.ctrlSeq="\\sqrt",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>',t.textTemplate=["sqrt(",")"],t.parser=function(){return B.optBlock.then((function(t){return B.block.map((function(e){var n=ct();return n.blocks=[t,e],t.adopt(n,0,0),e.adopt(n,t,0),n}))})).or(e.parser.call(this))},t.reflow=function(){var t=this.ends[w].jQ;K(t.prev(),1,t.innerHeight()/+t.css("fontSize").slice(0,-2)-.1)}})),S.hat=v(F,(function(t,e){t.ctrlSeq="\\hat",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-hat-prefix">^</span><span class="mq-hat-stem">&0</span></span>',t.textTemplate=["hat(",")"]})),ct=S.nthroot=v(lt,(function(t,e){t.htmlTemplate='<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>',t.textTemplate=["sqrt[","](",")"],t.latex=function(){return"\\sqrt["+this.ends[y].latex()+"]{"+this.ends[w].latex()+"}"}})),ut=v(F,(function(t,e){t.init=function(t,n,i){var r='<span class="mq-non-leaf"><span class="mq-diacritic-above">'+n+'</span><span class="mq-diacritic-stem">&0</span></span>';e.init.call(this,t,r,i)}})),S.vec=i(ut,"\\vec","&rarr;",["vec(",")"]),S.tilde=i(ut,"\\tilde","~",["tilde(",")"]),ft=v(v(F,d),(function(e,n){e.init=function(t,e,i,r,o){n.init.call(this,"\\left"+r,m,[e,i]),this.side=t,this.sides={},this.sides[y]={ch:e,ctrlSeq:r},this.sides[w]={ch:i,ctrlSeq:o}},e.numBlocks=function(){return 1},e.html=function(){return this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(this.side===w?" mq-ghost":"")+'">'+this.sides[y].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(this.side===y?" mq-ghost":"")+'">'+this.sides[w].ch+"</span></span>",n.html.call(this)},e.latex=function(){return"\\left"+this.sides[y].ctrlSeq+this.ends[y].latex()+"\\right"+this.sides[w].ctrlSeq},e.matchBrack=function(t,e,n){return n instanceof ft&&n.side&&n.side!==-e&&(!t.restrictMismatchedBrackets||ht[this.sides[this.side].ch]===n.sides[n.side].ch||{"(":"]","[":")"}[this.sides[y].ch]===n.sides[w].ch)&&n},e.closeOpposing=function(t){t.side=0,t.sides[this.side]=this.sides[this.side],t.delimjQs.eq(this.side===y?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)},e.createLeftOf=function(t){var e,i,r;this.replacedFragment||(e=t.options,i="|"===this.sides[y].ch?this.matchBrack(e,w,t[w])||this.matchBrack(e,y,t[y])||this.matchBrack(e,0,t.parent.parent):this.matchBrack(e,-this.side,t[-this.side])||this.matchBrack(e,-this.side,t.parent.parent)),i?(r=this.side=-i.side,this.closeOpposing(i),i===t.parent.parent&&t[r]&&O(t[r],t.parent.ends[r],-r).disown().withDirAdopt(-r,i.parent,i,i[r]).jQ.insDirOf(r,i.jQ),i.bubble("reflow")):(r=(i=this).side,i.replacedFragment?i.side=0:t[-r]&&(i.replaces(O(t[-r],t.parent.ends[-r],r)),t[-r]=0),n.createLeftOf.call(i,t)),r===y?t.insAtLeftEnd(i.ends[y]):t.insRightOf(i)},e.placeCursor=t,e.unwrap=function(){this.ends[y].children().disown().adopt(this.parent,this,this[w]).jQ.insertAfter(this.jQ),this.remove()},e.deleteSide=function(t,e,n){var i,r,o,s=this.parent,a=this[t],l=s.ends[t];if(t===this.side)return this.unwrap(),void(a?n.insDirOf(-t,a):n.insAtDirEnd(t,s));if(i=n.options,r=!this.side,this.side=-t,this.matchBrack(i,t,this.ends[y].ends[this.side]))this.closeOpposing(this.ends[y].ends[this.side]),o=this.ends[y].ends[t],this.unwrap(),o.siblingCreated&&o.siblingCreated(n.options,t),a?n.insDirOf(-t,a):n.insAtDirEnd(t,s);else{if(this.matchBrack(i,t,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else{if(e&&r)return this.unwrap(),void(a?n.insDirOf(-t,a):n.insAtDirEnd(t,s));this.sides[t]={ch:ht[this.sides[this.side].ch],ctrlSeq:ht[this.sides[this.side].ctrlSeq]},this.delimjQs.removeClass("mq-ghost").eq(t===y?0:1).addClass("mq-ghost").html(this.sides[t].ch)}a?(o=this.ends[y].ends[t],O(a,l,-t).disown().withDirAdopt(-t,this.ends[y],o,0).jQ.insAtDirEnd(t,this.ends[y].jQ.removeClass("mq-empty")),o.siblingCreated&&o.siblingCreated(n.options,t),n.insDirOf(-t,a)):e?n.insDirOf(t,this):n.insAtDirEnd(t,this.ends[y])}},e.deleteTowards=function(t,e){this.deleteSide(-t,!1,e)},e.finalizeTree=function(){this.ends[y].deleteOutOf=function(t,e){this.parent.deleteSide(t,!0,e)},this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(this.side===y?1:0).removeClass("mq-ghost"),this.side=0}},e.siblingCreated=function(t,e){e===-this.side&&this.finalizeTree()}})),ht={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},p("("),p("["),p("{","\\{"),S.langle=i(ft,y,"&lang;","&rang;","\\langle ","\\rangle "),S.rangle=i(ft,w,"&lang;","&rang;","\\langle ","\\rangle "),j["|"]=i(ft,y,"|","|","|","|"),S.lVert=i(ft,y,"&#8741;","&#8741;","\\lVert ","\\rVert "),S.rVert=i(ft,w,"&#8741;","&#8741;","\\lVert ","\\rVert "),S.left=v(F,(function(t){t.parser=function(){var t=M.regex,e=M.string,n=(M.succeed,M.optWhitespace);return n.then(t(/^(?:[([|]|\\\{|\\langle\b|\\lVert\b)/)).then((function(i){var r="\\"===i.charAt(0)?i.slice(1):i;return"\\langle"==i&&(r="&lang;",i+=" "),"\\lVert"==i&&(r="&#8741;",i+=" "),B.then((function(o){return e("\\right").skip(n).then(t(/^(?:[\])|]|\\\}|\\rangle\b|\\rVert\b)/)).map((function(t){var e,n="\\"===t.charAt(0)?t.slice(1):t;return"\\rangle"==t&&(n="&rang;",t+=" "),"\\rVert"==t&&(n="&#8741;",t+=" "),(e=ft(0,r,n,i,t)).blocks=[o],o.adopt(e,0,0),e}))}))}))}})),S.right=v(F,(function(t){t.parser=function(){return M.fail("unmatched \\right")}})),dt=S.binom=S.binomial=v(v(F,d),(function(t,e){t.ctrlSeq="\\binom",t.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>',t.textTemplate=["choose(",",",")"]})),S.choose=v(dt,(function(t){t.createLeftOf=at.prototype.createLeftOf})),S.editable=S.MathQuillMathField=v(F,(function(t,e){t.ctrlSeq="\\MathQuillMathField",t.htmlTemplate='<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>',t.parser=function(){var t=this,n=M.string,i=M.regex,r=M.succeed;return n("[").then(i(/^[a-z][a-z0-9]*/i)).skip(n("]")).map((function(e){t.name=e})).or(r()).then(e.parser.call(t))},t.finalizeTree=function(t){var e=E(this.ends[y],this.jQ,t);e.KIND_OF_MQ="MathField",e.editable=!0,e.createTextarea(),e.editablesTextareaEvents(),e.cursor.insAtRightEnd(e.root),u(e.root)},t.registerInnerField=function(t,e){t.push(t[this.name]=e(this.ends[y].controller))},t.latex=function(){return this.ends[y].latex()},t.text=function(){return this.ends[y].text()}})),pt=S.embed=v(H,(function(t,e){t.setOptions=function(t){function e(){return""}return this.text=t.text||e,this.htmlTemplate=t.htmlString||"",this.latex=t.latex||e,this},t.parser=function(){var t=this,e=M.string,n=M.regex,i=M.succeed;return e("{").then(n(/^[a-z][a-z0-9]*/i)).skip(e("}")).then((function(r){return e("[").then(n(/^[-\w\s]*/)).skip(e("]")).or(i()).map((function(e){return t.setOptions(D[r](e))}))}))}})),mt={},S.begin=v(F,(function(t,e){t.parser=function(){var t=M.string,e=M.regex;return t("{").then(e(/^[a-z]+/i)).skip(t("}")).then((function(e){return(mt[e]?mt[e]().parser():M.fail("unknown environment type: "+e)).skip(t("\\end{"+e+"}"))}))}})),bt=v(F,(function(t,e){t.template=[["\\begin{","}"],["\\end{","}"]],t.wrappers=function(){return[t.template[0].join(this.environment),t.template[1].join(this.environment)]}})),gt=mt.matrix=v(bt,(function(t,e){var n="&",i="\\\\";t.parentheses={left:null,right:null},t.environment="matrix",t.reflow=function(){var t=this.jQ.children("table"),e=t.outerHeight()/+t.css("fontSize").slice(0,-2),n=this.jQ.children(".mq-paren");n.length&&K(n,Mt(1+.2*(e-1),1.2),1.05*e)},t.latex=function(){var t,e="";return this.eachChild((function(r){void 0!==t&&(e+=t!==r.row?i:n),t=r.row,e+=r.latex()})),this.wrappers().join(e)},t.html=function(){function t(t){return t?'<span class="mq-scaled mq-paren">'+t+"</span>":""}var n,i=[],r="",o=0;return this.eachChild((function(t){n!==t.row&&(n=t.row,r+="<tr>$tds</tr>",i[n]=[]),i[n].push("<td>&"+o+++"</td>")})),this.htmlTemplate='<span class="mq-matrix mq-non-leaf">'+t(this.parentheses.left)+'<table class="mq-non-leaf">'+r.replace(/\$tds/g,(function(){return i.shift().join("")}))+"</table>"+t(this.parentheses.right)+"</span>",e.html.call(this)},t.createBlocks=function(){this.blocks=[vt(0,this),vt(0,this),vt(1,this),vt(1,this)]},t.parser=function(){var t=this,e=M.optWhitespace,r=M.string;return e.then(r(n).or(r(i)).or(B.block)).many().skip(e).then((function(e){function n(){t.blocks.push(vt(s,t,o)),o=[]}var r,o=[],s=0;for(t.blocks=[],r=0;r<e.length;r+=1)e[r]instanceof W?o.push(e[r]):(n(),e[r]===i&&(s+=1));return n(),t.autocorrect(),M.succeed(t)}))},t.finalizeTree=function(){var t=this.jQ.find("table");t.toggleClass("mq-rows-1",1===t.find("tr").length),this.relink()},t.getEntryPoint=function(t,e,n){return"up"===n?t===y?this.blocks[this.rowSize-1]:this.blocks[0]:t===y?this.blocks[this.blocks.length-1]:this.blocks[this.blocks.length-this.rowSize]},t.atExitPoint=function(t,e){var n=this.blocks.indexOf(e.parent);return t===y?n%this.rowSize==0:(n+1)%this.rowSize==0},t.moveTowards=function(t,e,n){var i=n&&this.getEntryPoint(t,e,n);e.insAtDirEnd(-t,i||this.ends[-t])},t.relink=function(){var t,e,n,i,r=this.blocks,o=[];for(this.rowSize=r.length,i=0;i<r.length;i+=1)t!==(n=r[i]).row&&(1===n.row&&(this.rowSize=e),o[t=n.row]=[],e=0),o[t][e]=n,n[w]=r[i+1],n[y]=r[i-1],o[t-1]&&o[t-1][e]&&(n.upOutOf=o[t-1][e],o[t-1][e].downOutOf=n),e+=1;this.ends[y]=r[0],this.ends[w]=r[r.length-1]},t.autocorrect=function(t){var e,n,i,r,o,s,a=[];for(t=[],e=this.blocks,s=0;s<e.length;s+=1)t[o=e[s].row]=t[o]||[],t[o].push(e[s]),a[o]=t[o].length;if((n=Math.max.apply(null,a))!==Math.min.apply(null,a)){for(s=0;s<t.length;s+=1)for(i=n-t[s].length;i;)r=n*s+t[s].length,e.splice(r,0,vt(s,this)),i-=1;this.relink()}},t.deleteCell=function(t){function e(t){var e,n=[];for(e=0;e<t.length;e+=1)t[e].isEmpty()&&n.push(t[e]);return n.length===t.length}function n(t){for(var e=0;e<t.length;e+=1)c.indexOf(t[e])>-1&&(t[e].remove(),c.splice(c.indexOf(t[e]),1))}var i,r,o=[],s=[],a=[],l=[],c=this.blocks;this.eachChild((function(e){i!==e.row&&(i=e.row,o[i]=[],r=0),s[r]=s[r]||[],s[r].push(e),o[i].push(e),e===t&&(a=o[i],l=s[r]),r+=1})),e(a)&&l.length>1&&(i=o.indexOf(a),this.eachChild((function(t){t.row>i&&(t.row-=1)})),n(a),this.jQ.find("tr").eq(i).remove()),e(l)&&a.length>1&&n(l),this.finalizeTree()},t.addRow=function(t){var e,n,i,r=[],o=[],s=[],a=q("<tr></tr>"),l=t.row,c=0;for(this.eachChild((function(e){e.row<=l&&r.push(e),e.row===l&&(e===t&&(n=c),c+=1),e.row>l&&(e.row+=1,s.push(e))})),i=0;i<c;i+=1)(e=vt(l+1)).parent=this,o.push(e),e.jQ=q('<td class="mq-empty">').attr(It,e.id).appendTo(a);return this.jQ.find("tr").eq(l).after(a),this.blocks=r.concat(o,s),o[n]},t.addColumn=function(t){var e,n,i,r=[],o=[];for(this.eachChild((function(n){r[n.row]=r[n.row]||[],r[n.row].push(n),n===t&&(e=r[n.row].length)})),i=0;i<r.length;i+=1)(n=vt(i)).parent=this,o.push(n),r[i].splice(e,0,n),n.jQ=q('<td class="mq-empty">').attr(It,n.id);return this.jQ.find("tr").each((function(t){q(this).find("td").eq(e-1).after(r[t][e].jQ)})),this.blocks=[].concat.apply([],r),o[t.row]},t.insert=function(t,e){var n=this[t](e);this.cursor=this.cursor||this.parent.cursor,this.finalizeTree(),this.bubble("reflow").cursor.insAtRightEnd(n)},t.backspace=function(t,e,n,i){var r=t[e];if(t.isEmpty()){for(this.deleteCell(t);r&&r[e]&&-1===this.blocks.indexOf(r);)r=r[e];r&&n.insAtDirEnd(-e,r),1===this.blocks.length&&this.blocks[0].isEmpty()&&(i(),this.finalizeTree()),this.bubble("edited")}}})),mt.pmatrix=v(gt,(function(t,e){t.environment="pmatrix",t.parentheses={left:"(",right:")"}})),mt.bmatrix=v(gt,(function(t,e){t.environment="bmatrix",t.parentheses={left:"[",right:"]"}})),mt.Bmatrix=v(gt,(function(t,e){t.environment="Bmatrix",t.parentheses={left:"{",right:"}"}})),mt.vmatrix=v(gt,(function(t,e){t.environment="vmatrix",t.parentheses={left:"|",right:"|"}})),mt.Vmatrix=v(gt,(function(t,e){t.environment="Vmatrix",t.parentheses={left:"&#8214;",right:"&#8214;"}})),vt=v(W,(function(t,e){t.init=function(t,n,i){if(e.init.call(this),this.row=t,n&&this.adopt(n,n.ends[w],0),i)for(var r=0;r<i.length;r++)i[r].children().adopt(this,this.ends[w],0)},t.keystroke=function(t,n,i){switch(t){case"Shift-Spacebar":return n.preventDefault(),this.parent.insert("addColumn",this);case"Shift-Enter":return this.parent.insert("addRow",this)}return e.keystroke.apply(this,arguments)},t.deleteOutOf=function(t,n){var i=this,r=arguments;this.parent.backspace(this,t,n,(function(){return e.deleteOutOf.apply(i,r)}))},t.moveOutOf=function(t,e,n){n&&this.parent.atExitPoint(t,e)||!this[t]?e.insDirOf(t,this.parent):e.insAtDirEnd(-t,this[t])}})),S.notin=S.cong=S.equiv=S.oplus=S.otimes=v(U,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),S["≠"]=S.ne=S.neq=i(U,"\\ne ","&ne;"),S["∗"]=S.ast=S.star=S.loast=S.lowast=i(U,"\\ast ","&lowast;"),S.therefor=S.therefore=i(U,"\\therefore ","&there4;"),S.cuz=S.because=i(U,"\\because ","&#8757;"),S.prop=S.propto=i(U,"\\propto ","&prop;"),S["≈"]=S.asymp=S.approx=i(U,"\\approx ","&asymp;"),S.isin=S.in=i(U,"\\in ","&isin;"),S.ni=S.contains=i(U,"\\ni ","&ni;"),S.notni=S.niton=S.notcontains=S.doesnotcontain=i(U,"\\not\\ni ","&#8716;"),S.sub=S.subset=i(U,"\\subset ","&sub;"),S.sup=S.supset=S.superset=i(U,"\\supset ","&sup;"),S.nsub=S.notsub=S.nsubset=S.notsubset=i(U,"\\not\\subset ","&#8836;"),S.nsup=S.notsup=S.nsupset=S.notsupset=S.nsuperset=S.notsuperset=i(U,"\\not\\supset ","&#8837;"),S.sube=S.subeq=S.subsete=S.subseteq=i(U,"\\subseteq ","&sube;"),S.supe=S.supeq=S.supsete=S.supseteq=S.supersete=S.superseteq=i(U,"\\supseteq ","&supe;"),S.nsube=S.nsubeq=S.notsube=S.notsubeq=S.nsubsete=S.nsubseteq=S.notsubsete=S.notsubseteq=i(U,"\\not\\subseteq ","&#8840;"),S.nsupe=S.nsupeq=S.notsupe=S.notsupeq=S.nsupsete=S.nsupseteq=S.notsupsete=S.notsupseteq=S.nsupersete=S.nsuperseteq=S.notsupersete=S.notsuperseteq=i(U,"\\not\\supseteq ","&#8841;"),S.N=S.naturals=S.Naturals=i($,"\\mathbb{N}","&#8469;"),S.P=S.primes=S.Primes=S.projective=S.Projective=S.probability=S.Probability=i($,"\\mathbb{P}","&#8473;"),S.Z=S.integers=S.Integers=i($,"\\mathbb{Z}","&#8484;"),S.Q=S.rationals=S.Rationals=i($,"\\mathbb{Q}","&#8474;"),S.R=S.reals=S.Reals=i($,"\\mathbb{R}","&#8477;"),S.C=S.complex=S.Complex=S.complexes=S.Complexes=S.complexplane=S.Complexplane=S.ComplexPlane=i($,"\\mathbb{C}","&#8450;"),S.H=S.Hamiltonian=S.quaternions=S.Quaternions=i($,"\\mathbb{H}","&#8461;"),S.quad=S.emsp=i($,"\\quad ","    "),S.qquad=i($,"\\qquad ","        "),S.diamond=i($,"\\diamond ","&#9671;"),S.bigtriangleup=i($,"\\bigtriangleup ","&#9651;"),S.ominus=i($,"\\ominus ","&#8854;"),S.uplus=i($,"\\uplus ","&#8846;"),S.bigtriangledown=i($,"\\bigtriangledown ","&#9661;"),S.sqcap=i($,"\\sqcap ","&#8851;"),S.triangleleft=i($,"\\triangleleft ","&#8882;"),S.sqcup=i($,"\\sqcup ","&#8852;"),S.triangleright=i($,"\\triangleright ","&#8883;"),S.odot=S.circledot=i($,"\\odot ","&#8857;"),S.bigcirc=i($,"\\bigcirc ","&#9711;"),S.dagger=i($,"\\dagger ","&#0134;"),S.ddagger=i($,"\\ddagger ","&#135;"),S.wr=i($,"\\wr ","&#8768;"),S.amalg=i($,"\\amalg ","&#8720;"),S.models=i($,"\\models ","&#8872;"),S.prec=i($,"\\prec ","&#8826;"),S.succ=i($,"\\succ ","&#8827;"),S.preceq=i($,"\\preceq ","&#8828;"),S.succeq=i($,"\\succeq ","&#8829;"),S.simeq=i($,"\\simeq ","&#8771;"),S.mid=i($,"\\mid ","&#8739;"),S.ll=i($,"\\ll ","&#8810;"),S.gg=i($,"\\gg ","&#8811;"),S.parallel=i($,"\\parallel ","&#8741;"),S.nparallel=i($,"\\nparallel ","&#8742;"),S.bowtie=i($,"\\bowtie ","&#8904;"),S.sqsubset=i($,"\\sqsubset ","&#8847;"),S.sqsupset=i($,"\\sqsupset ","&#8848;"),S.smile=i($,"\\smile ","&#8995;"),S.sqsubseteq=i($,"\\sqsubseteq ","&#8849;"),S.sqsupseteq=i($,"\\sqsupseteq ","&#8850;"),S.doteq=i($,"\\doteq ","&#8784;"),S.frown=i($,"\\frown ","&#8994;"),S.vdash=i($,"\\vdash ","&#8870;"),S.dashv=i($,"\\dashv ","&#8867;"),S.nless=i($,"\\nless ","&#8814;"),S.ngtr=i($,"\\ngtr ","&#8815;"),S.longleftarrow=i($,"\\longleftarrow ","&#8592;"),S.longrightarrow=i($,"\\longrightarrow ","&#8594;"),S.Longleftarrow=i($,"\\Longleftarrow ","&#8656;"),S.Longrightarrow=i($,"\\Longrightarrow ","&#8658;"),S.longleftrightarrow=i($,"\\longleftrightarrow ","&#8596;"),S.updownarrow=i($,"\\updownarrow ","&#8597;"),S.Longleftrightarrow=i($,"\\Longleftrightarrow ","&#8660;"),S.Updownarrow=i($,"\\Updownarrow ","&#8661;"),S.mapsto=i($,"\\mapsto ","&#8614;"),S.nearrow=i($,"\\nearrow ","&#8599;"),S.hookleftarrow=i($,"\\hookleftarrow ","&#8617;"),S.hookrightarrow=i($,"\\hookrightarrow ","&#8618;"),S.searrow=i($,"\\searrow ","&#8600;"),S.leftharpoonup=i($,"\\leftharpoonup ","&#8636;"),S.rightharpoonup=i($,"\\rightharpoonup ","&#8640;"),S.swarrow=i($,"\\swarrow ","&#8601;"),S.leftharpoondown=i($,"\\leftharpoondown ","&#8637;"),S.rightharpoondown=i($,"\\rightharpoondown ","&#8641;"),S.nwarrow=i($,"\\nwarrow ","&#8598;"),S.ldots=i($,"\\ldots ","&#8230;"),S.cdots=i($,"\\cdots ","&#8943;"),S.vdots=i($,"\\vdots ","&#8942;"),S.ddots=i($,"\\ddots ","&#8945;"),S.surd=i($,"\\surd ","&#8730;"),S.triangle=i($,"\\triangle ","&#9651;"),S.ell=i($,"\\ell ","&#8467;"),S.top=i($,"\\top ","&#8868;"),S.flat=i($,"\\flat ","&#9837;"),S.natural=i($,"\\natural ","&#9838;"),S.sharp=i($,"\\sharp ","&#9839;"),S.wp=i($,"\\wp ","&#8472;"),S.bot=i($,"\\bot ","&#8869;"),S.clubsuit=i($,"\\clubsuit ","&#9827;"),S.diamondsuit=i($,"\\diamondsuit ","&#9826;"),S.heartsuit=i($,"\\heartsuit ","&#9825;"),S.spadesuit=i($,"\\spadesuit ","&#9824;"),S.parallelogram=i($,"\\parallelogram ","&#9649;"),S.square=i($,"\\square ","&#11036;"),S.oint=i($,"\\oint ","&#8750;"),S.bigcap=i($,"\\bigcap ","&#8745;"),S.bigcup=i($,"\\bigcup ","&#8746;"),S.bigsqcup=i($,"\\bigsqcup ","&#8852;"),S.bigvee=i($,"\\bigvee ","&#8744;"),S.bigwedge=i($,"\\bigwedge ","&#8743;"),S.bigodot=i($,"\\bigodot ","&#8857;"),S.bigotimes=i($,"\\bigotimes ","&#8855;"),S.bigoplus=i($,"\\bigoplus ","&#8853;"),S.biguplus=i($,"\\biguplus ","&#8846;"),S.lfloor=i($,"\\lfloor ","&#8970;"),S.rfloor=i($,"\\rfloor ","&#8971;"),S.lceil=i($,"\\lceil ","&#8968;"),S.rceil=i($,"\\rceil ","&#8969;"),S.opencurlybrace=S.lbrace=i($,"\\lbrace ","{"),S.closecurlybrace=S.rbrace=i($,"\\rbrace ","}"),S.lbrack=i($,"["),S.rbrack=i($,"]"),S.slash=i($,"/"),S.vert=i($,"|"),S.perp=S.perpendicular=i($,"\\perp ","&perp;"),S.nabla=S.del=i($,"\\nabla ","&nabla;"),S.hbar=i($,"\\hbar ","&#8463;"),S.AA=S.Angstrom=S.angstrom=i($,"\\text\\AA ","&#8491;"),S.ring=S.circ=S.circle=i($,"\\circ ","&#8728;"),S.bull=S.bullet=i($,"\\bullet ","&bull;"),S.setminus=S.smallsetminus=i($,"\\setminus ","&#8726;"),S.not=S["¬"]=S.neg=i($,"\\neg ","&not;"),S["…"]=S.dots=S.ellip=S.hellip=S.ellipsis=S.hellipsis=i($,"\\dots ","&hellip;"),S.converges=S.darr=S.dnarr=S.dnarrow=S.downarrow=i($,"\\downarrow ","&darr;"),S.dArr=S.dnArr=S.dnArrow=S.Downarrow=i($,"\\Downarrow ","&dArr;"),S.diverges=S.uarr=S.uparrow=i($,"\\uparrow ","&uarr;"),S.uArr=S.Uparrow=i($,"\\Uparrow ","&uArr;"),S.to=i(U,"\\to ","&rarr;"),S.rarr=S.rightarrow=i($,"\\rightarrow ","&rarr;"),S.implies=i(U,"\\Rightarrow ","&rArr;"),S.rArr=S.Rightarrow=i($,"\\Rightarrow ","&rArr;"),S.gets=i(U,"\\gets ","&larr;"),S.larr=S.leftarrow=i($,"\\leftarrow ","&larr;"),S.impliedby=i(U,"\\Leftarrow ","&lArr;"),S.lArr=S.Leftarrow=i($,"\\Leftarrow ","&lArr;"),S.harr=S.lrarr=S.leftrightarrow=i($,"\\leftrightarrow ","&harr;"),S.iff=i(U,"\\Leftrightarrow ","&hArr;"),S.hArr=S.lrArr=S.Leftrightarrow=i($,"\\Leftrightarrow ","&hArr;"),S.Re=S.Real=S.real=i($,"\\Re ","&real;"),S.Im=S.imag=S.image=S.imagin=S.imaginary=S.Imaginary=i($,"\\Im ","&image;"),S.part=S.partial=i($,"\\partial ","&part;"),S.infty=S.infin=S.infinity=i($,"\\infty ","&infin;"),S.alef=S.alefsym=S.aleph=S.alephsym=i($,"\\aleph ","&alefsym;"),S.xist=S.xists=S.exist=S.exists=i($,"\\exists ","&exist;"),S.nexists=S.nexist=i($,"\\nexists ","&#8708;"),S.and=S.land=S.wedge=i(U,"\\wedge ","&and;"),S.or=S.lor=S.vee=i(U,"\\vee ","&or;"),S.o=S.O=S.empty=S.emptyset=S.oslash=S.Oslash=S.nothing=S.varnothing=i(U,"\\varnothing ","&empty;"),S.cup=S.union=i(U,"\\cup ","&cup;"),S.cap=S.intersect=S.intersection=i(U,"\\cap ","&cap;"),S.deg=S.degree=i($,"\\degree ","&deg;"),S.ang=S.angle=i($,"\\angle ","&ang;"),S.measuredangle=i($,"\\measuredangle ","&#8737;"),yt=v($,(function(t,e){t.createLeftOf=function(t){t.options.autoSubscriptNumerals&&t.parent!==t.parent.parent.sub&&(t[y]instanceof wt&&!1!==t[y].isItalic||t[y]instanceof rt&&t[y][y]instanceof wt&&!1!==t[y][y].isItalic)?(S._().createLeftOf(t),e.createLeftOf.call(this,t),t.insRightOf(t.parent.parent)):e.createLeftOf.call(this,t)}})),wt=v(H,(function(t,e){t.init=function(t,n){e.init.call(this,t,"<var>"+(n||t)+"</var>")},t.text=function(){var t=this.ctrlSeq;return this.isPartOfOperator?"\\"==t[0]?t=t.slice(1,t.length):" "==t[t.length-1]&&(t=t.slice(0,-1)):(!this[y]||this[y]instanceof wt||this[y]instanceof U||"\\ "===this[y].ctrlSeq||(t="*"+t),!this[w]||this[w]instanceof U||this[w]instanceof rt||(t+="*")),t}})),z.p.autoCommands={_maxLength:0},A.autoCommands=function(t){var e,n,i,r,o;if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){if((o=e[r]).length<2)throw'autocommand "'+o+'" not minimum length of 2';if(S[o]===St)throw'"'+o+'" is a built-in operator name';n[o]=1,i=Bt(i,o.length)}return n._maxLength=i,n},qt=v(wt,(function(t,e){function n(t){return!t||t instanceof U||t instanceof ot}t.init=function(t){return e.init.call(this,this.letter=t)},t.createLeftOf=function(t){var n,i,r,o,s;if(e.createLeftOf.apply(this,arguments),(i=(n=t.options.autoCommands)._maxLength)>0){for(r="",o=this,s=0;o instanceof qt&&o.ctrlSeq===o.letter&&s<i;)r=o.letter+r,o=o[y],s+=1;for(;r.length;){if(n.hasOwnProperty(r)){for(s=1,o=this;s<r.length;s+=1,o=o[y]);return O(o,this).remove(),t[y]=o[y],S[r](r).createLeftOf(t)}r=r.slice(1)}}},t.italicize=function(t){return this.isItalic=t,this.isPartOfOperator=!t,this.jQ.toggleClass("mq-operator-name",!t),this},t.finalizeTree=t.siblingDeleted=t.siblingCreated=function(t,e){e!==y&&this[w]instanceof qt||this.autoUnItalicize(t)},t.autoUnItalicize=function(t){var e,i,r,o,s,a,l,c,u,f,h,d,p=t.autoOperatorNames;if(0!==p._maxLength){for(e=this.letter,i=this[y];i instanceof qt;i=i[y])e=i.letter+e;for(r=this[w];r instanceof qt;r=r[w])e+=r.letter;O(i[w]||this.parent.ends[y],r[y]||this.parent.ends[w]).each((function(t){t.italicize(!0).jQ.removeClass("mq-first mq-last mq-followed-by-supsub"),t.ctrlSeq=t.letter}));t:for(o=0,s=i[w]||this.parent.ends[y];o<e.length;o+=1,s=s[w])for(a=Mt(p._maxLength,e.length-o);a>0;a-=1)if(l=e.slice(o,o+a),p.hasOwnProperty(l)){for(c=0,u=s;c<a;c+=1,u=u[w])u.italicize(!1),f=u;h=xt.hasOwnProperty(l),s.ctrlSeq=(h?"\\":"\\operatorname{")+s.ctrlSeq,f.ctrlSeq+=h?" ":"}",Ot.hasOwnProperty(l)&&f[y][y][y].jQ.addClass("mq-last"),n(s[y])||s.jQ.addClass("mq-first"),n(f[w])||(f[w]instanceof rt?((d=f[w]).siblingCreated=d.siblingDeleted=function(){d.jQ.toggleClass("mq-after-operator-name",!(d[w]instanceof ft))})():f.jQ.toggleClass("mq-last",!(f[w]instanceof ft))),o+=a-1,s=f;continue t}}}})),xt={},kt=z.p.autoOperatorNames={_maxLength:9},Ot={limsup:1,liminf:1,projlim:1,injlim:1},function(){var t,e,n,i,r="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" ");for(t=0;t<r.length;t+=1)xt[r[t]]=kt[r[t]]=1;for(e="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),t=0;t<e.length;t+=1)xt[e[t]]=1;for(n="sin cos tan sec cosec csc cotan cot ctg".split(" "),t=0;t<n.length;t+=1)kt[n[t]]=kt["arc"+n[t]]=kt[n[t]+"h"]=kt["ar"+n[t]+"h"]=kt["arc"+n[t]+"h"]=1;for(i="gcf hcf lcm proj span".split(" "),t=0;t<i.length;t+=1)kt[i[t]]=1}(),A.autoOperatorNames=function(t){var e,n,i,r,o;if(!/^[a-z]+(?: [a-z]+)*$/i.test(t))throw'"'+t+'" not a space-delimited list of only letters';for(e=t.split(" "),n={},i=0,r=0;r<e.length;r+=1){if((o=e[r]).length<2)throw'"'+o+'" not minimum length of 2';n[o]=1,i=Bt(i,o.length)}return n._maxLength=i,n},St=v(H,(function(t,e){t.init=function(t){this.ctrlSeq=t},t.createLeftOf=function(t){var e,n=this.ctrlSeq;for(e=0;e<n.length;e+=1)qt(n.charAt(e)).createLeftOf(t)},t.parser=function(){var t,e=this.ctrlSeq,n=W();for(t=0;t<e.length;t+=1)qt(e.charAt(t)).adopt(n,n.ends[w],0);return M.succeed(n.children())}})),kt)kt.hasOwnProperty(jt)&&(S[jt]=St);for(Rt in S.operatorname=v(F,(function(e){e.createLeftOf=t,e.numBlocks=function(){return 1},e.parser=function(){return B.block.map((function(t){return t.children()}))}})),S.f=v(qt,(function(t,e){t.init=function(){H.p.init.call(this,this.letter="f",'<var class="mq-f">f</var>')},t.italicize=function(t){return this.jQ.html("f").toggleClass("mq-f",t),e.italicize.apply(this,arguments)}})),S[" "]=S.space=i($,"\\ ","&nbsp;"),S["'"]=S.prime=i($,"'","&prime;"),S["″"]=S.dprime=i($,"″","&Prime;"),S.backslash=i($,"\\backslash ","\\"),j["\\"]||(j["\\"]=S.backslash),S.$=i($,"\\$","$"),Ct=v(H,(function(t,e){t.init=function(t,n){e.init.call(this,t,'<span class="mq-nonSymbola">'+(n||t)+"</span>")}})),S["@"]=Ct,S["&"]=i(Ct,"\\&","&amp;"),S["%"]=i(Ct,"\\%","%"),S.alpha=S.beta=S.gamma=S.delta=S.zeta=S.eta=S.theta=S.iota=S.kappa=S.mu=S.nu=S.xi=S.rho=S.sigma=S.tau=S.chi=S.psi=S.omega=v(wt,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),S.phi=i(wt,"\\phi ","&#981;"),S.phiv=S.varphi=i(wt,"\\varphi ","&phi;"),S.epsilon=i(wt,"\\epsilon ","&#1013;"),S.epsiv=S.varepsilon=i(wt,"\\varepsilon ","&epsilon;"),S.piv=S.varpi=i(wt,"\\varpi ","&piv;"),S.sigmaf=S.sigmav=S.varsigma=i(wt,"\\varsigma ","&sigmaf;"),S.thetav=S.vartheta=S.thetasym=i(wt,"\\vartheta ","&thetasym;"),S.upsilon=S.upsi=i(wt,"\\upsilon ","&upsilon;"),S.gammad=S.Gammad=S.digamma=i(wt,"\\digamma ","&#989;"),S.kappav=S.varkappa=i(wt,"\\varkappa ","&#1008;"),S.rhov=S.varrho=i(wt,"\\varrho ","&#1009;"),S.pi=S["π"]=i(Ct,"\\pi ","&pi;"),S.lambda=i(Ct,"\\lambda ","&lambda;"),S.Upsilon=S.Upsi=S.upsih=S.Upsih=i(H,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),S.Gamma=S.Delta=S.Theta=S.Lambda=S.Xi=S.Pi=S.Sigma=S.Phi=S.Psi=S.Omega=S.forall=v($,(function(t,e){t.init=function(t){e.init.call(this,"\\"+t+" ","&"+t+";")}})),Tt=v(F,(function(t){t.init=function(t){this.latex=t},t.createLeftOf=function(t){var e=B.parse(this.latex);e.children().adopt(t.parent,t[y],t[w]),t[y]=e.ends[w],e.jQize().insertBefore(t.jQ),e.finalizeInsert(t.options,t),e.ends[w][w].siblingCreated&&e.ends[w][w].siblingCreated(t.options,y),e.ends[y][y].siblingCreated&&e.ends[y][y].siblingCreated(t.options,w),t.parent.bubble("reflow")},t.parser=function(){var t=B.parse(this.latex).children();return M.succeed(t)}})),S["¹"]=i(Tt,"^1"),S["²"]=i(Tt,"^2"),S["³"]=i(Tt,"^3"),S["¼"]=i(Tt,"\\frac14"),S["½"]=i(Tt,"\\frac12"),S["¾"]=i(Tt,"\\frac34"),Et=v(U,(function(t){t.init=$.prototype.init,t.contactWeld=t.siblingCreated=t.siblingDeleted=function(t,e){if(e!==w)return this.jQ[0].className=function t(e){return e[y]?e[y]instanceof U||/^[,;:\(\[]$/.test(e[y].ctrlSeq)?"":"mq-binary-operator":e.parent&&e.parent.parent&&e.parent.parent.isStyleBlock()?t(e.parent.parent):""}(this),this}})),S["+"]=i(Et,"+","+"),S["–"]=S["-"]=i(Et,"-","&minus;"),S["±"]=S.pm=S.plusmn=S.plusminus=i(Et,"\\pm ","&plusmn;"),S.mp=S.mnplus=S.minusplus=i(Et,"\\mp ","&#8723;"),j["*"]=S.sdot=S.cdot=i(U,"\\cdot ","&middot;","*"),_t=v(U,(function(t,e){t.init=function(t,n){this.data=t,this.strict=n;var i=n?"Strict":"";e.init.call(this,t["ctrlSeq"+i],t["html"+i],t["text"+i])},t.swap=function(t){this.strict=t;var e=t?"Strict":"";this.ctrlSeq=this.data["ctrlSeq"+e],this.jQ.html(this.data["html"+e]),this.textTemplate=[this.data["text"+e]]},t.deleteTowards=function(t,n){if(t===y&&!this.strict)return this.swap(!0),void this.bubble("reflow");e.deleteTowards.apply(this,arguments)}})),zt={ctrlSeq:"\\le ",html:"&le;",text:"≤",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"},At={ctrlSeq:"\\ge ",html:"&ge;",text:"≥",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"},S["<"]=S.lt=i(_t,zt,!0),S[">"]=S.gt=i(_t,At,!0),S["≤"]=S.le=S.leq=i(_t,zt,!1),S["≥"]=S.ge=S.geq=i(_t,At,!1),Qt=v(U,(function(t,e){t.init=function(){e.init.call(this,"=","=")},t.createLeftOf=function(t){if(t[y]instanceof _t&&t[y].strict)return t[y].swap(!1),void t[y].bubble("reflow");e.createLeftOf.apply(this,arguments)}})),S["="]=Qt,S["×"]=S.times=i(U,"\\times ","&times;","[x]"),S["÷"]=S.div=S.divide=S.divides=i(U,"\\div ","&divide;","[/]"),j["~"]=S.sim=i(U,"\\sim ","~","~"),Dt=c(1))!function(t,e){"function"==typeof e?(l[t]=function(){return a(),e.apply(this,arguments)},l[t].prototype=e.prototype):l[t]=e}(Rt,Dt[Rt])}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.nc=void 0,function(){"use strict";function t(e,n){n=n||0,window.require&&"function"==typeof window.require?e():n>15?console.error("ERROR: Cannot find requirejs"):window.setTimeout((function(){t(e,n+1)}),500)}function e(t,e){var n=document.createElement(t);return Object.keys(e).forEach((function(t){var i=e[t];"class"===t?i.trim().split(/\s+/).forEach((function(t){n.classList.add(t)})):"style"===t?i.split(";").forEach((function(t){var e=t.split(":");2===e.length&&n.style.setProperty(e[0].trim(),e[1].trim())})):"html"===t?n.innerHTML=i:n.setAttribute(t,i)})),n}function i(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}}function r(t){t.forEach((function(t){var e=window.IB;if(t.meta){var n=t.meta;if(e.sd[n.name]&&"function"==typeof e.sd[n.name].init)return console.error("Warning: component '".concat(n.name,"' loaded twice.")),void e.sd[n.name].init();!function i(){e.sd[n.name]=e.sd[n.name]||{inst:{},_class:t,init:i,dispose:null};var r=n.query||'div[role="snptd_'.concat(n.name,'"], div[data-snptd="').concat(n.name,'"]');if("body"===r){if(e.sd[n.name].singl)return void console.error("Singleton already defined");var o=document.querySelector("body"),s=new t(o);s.init(),e.sd[n.name].singl=s,console.log("_init: Initialized singleton '".concat(n.name,"' instance."))}else{var a=function(t){return document.querySelectorAll(t)}(r),l=0;a.forEach((function(i){var r=i,o=r.getAttribute("id");if(o||(o="sd_"+Math.random().toString(32).substring(2),r.setAttribute("id",o)),"1"!==r.dataset.active){var s=new t(r);s.init(),null!=e.sd[n.name].inst&&(e.sd[n.name].inst[o]=s),l++}else console.warn("Warning: Element '".concat(n.name,"' ").concat(o," already processed."))})),console.log("_init: Initialized ".concat(l," '").concat(n.name,"' instances."))}}();e.sd[n.name].dispose=function(){var t=0;window.IB&&window.IB.sd&&window.IB.sd[n.name]&&window.IB.sd[n.name].inst&&(Object.keys(window.IB.sd[n.name].inst).forEach((function(i){var r=window.IB.sd[n.name].inst[i];r&&(r.dispose(),t++,delete e.sd[n.name].inst[i])})),console.log("_dispose: Destroyed ".concat(t," '").concat(n.name,"' instances.")))}}else console.error("Missing meta in class ",t,". Annotate it with @Component")}))}var o=function(e){window.IB=window.IB||{sd:{}};var n=e;n.map((function(t){var e;return(null===(e=t.meta)||void 0===e?void 0:e.use$)||!1})).reduce((function(t,e){return e||t}))?t((function(){requirejs(["jquery"],(function(){$((function(){"function"==typeof window.ibComponentLoader&&window.ibComponentLoader(),r(n)}))}))}),15):r(n)},s=n(379),a=n.n(s),l=n(795),c=n.n(l),u=n(569),f=n.n(u),h=n(565),d=n.n(h),p=n(216),m=n.n(p),b=n(589),g=n.n(b),v=n(982),y={};y.styleTagTransform=g(),y.setAttributes=d(),y.insert=f().bind(null,"head"),y.domAPI=c(),y.insertStyleElement=m();a()(v.Z,y),v.Z&&v.Z.locals&&v.Z.locals;var w=n(436),q={};q.styleTagTransform=g(),q.setAttributes=d(),q.insert=f().bind(null,"head"),q.domAPI=c(),q.insertStyleElement=m();a()(w.Z,q),w.Z&&w.Z.locals&&w.Z.locals,n(625);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,o=void 0,o=function(t,e){if("object"!==x(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==x(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===x(o)?o:String(o)),i)}var r,o}function O(t,e,n){return e&&k(t.prototype,e),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var S=O((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.parent=e}));function j(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var T={name:"",author:"",version:"1.0",use$:!1};function E(t){return function(e){var n=e.prototype.connectedCallback,i=t.elementName,r=t.classes,o=t.styles;e.prototype.connectedCallback=function(){var t;r&&(t=this.classList).add.apply(t,j(r));o&&Object.assign(this.style,o),n&&n.apply(this)},console.log("Calling customElements define for ",i,e),customElements.define(i,e)}}var _={ca:{check:"Comprova",chooseone:"Tria una opció",right:"Ben fet!",wrong:"Ho sento. Intentau-ho de nou",error:"Hi ha hagut un error processant la resposta",random_msg:"Aquestes activitats contenen preguntes aleatòries que es generen cada vegada que es carrega la pàgina."},es:{check:"Comprueba",chooseone:"Elige una opción",right:"¡Bien hecho!",wrong:"Lo siento. Inténtalo de nuevo.",error:"Ha habido un error procesando la respuesta",random_msg:"Estas actividades contienen preguntas aleatorias que se generan cada vez que se carga la página."},en:{check:"Check",chooseone:"Choose one",right:"Well done!",wrong:"Try it again.",error:"There has been an error processing the answer",random_msg:"These activities contain random questions that are generated at every page load."},fr:{check:"Vérifier",chooseone:"Choisis une option",right:"¡Bien hecho!",wrong:"Lo siento. Inténtalo de nuevo.",error:"Ha habido un error procesando la respuesta",random_msg:"Estas actividades contienen preguntas aleatorias que se generan cada vez que se carga la página."},de:{check:"Prüfen",chooseone:"Wähle eine option",right:"¡Bien hecho!",wrong:"Lo siento. Inténtalo de nuevo.",error:"Ha habido un error procesando la respuesta",random_msg:"Estas actividades contienen preguntas aleatorias que se generan cada vez que se carga la página."}};function z(t,e){var n=_[t];return n||(n=_.ca),n[e]||e}function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function Q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,o=void 0,o=function(t,e){if("object"!==A(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==A(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===A(o)?o:String(o)),i)}var r,o}var D,R=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elem=$('\n            <div class="modal fade moodle-dialogue" id="'.concat(e,'" tabindex="-1" aria-labelledby="bsdialog" aria-hidden="true">\n            <div class="modal-dialog">\n                <div class="modal-content">\n                  <div class="modal-header">\n                    <h5 class="modal-title">').concat(n,'</h5>\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n                      <span aria-hidden="true">&times;</span>\n                    </button>\n                  </div>\n                  <div class="modal-body" style="max-height:450px;overflow-y:auto;">\n                  </div>\n                  <div class="modal-footer">\n                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Acceptar</button>\n                   </div>\n                </div>\n                </div>')),this.body=this.elem.find("div.modal-body"),this.header=this.elem.find("h5.modal-title"),$("body").append(this.elem)}var e,n,i;return e=t,(n=[{key:"clearBody",value:function(){this.body.html("")}},{key:"setBody",value:function(t){this.clearBody(),this.body.append($(t))}},{key:"setTitle",value:function(t){this.header.html(t)}},{key:"show",value:function(){this.elem.modal("show")}}])&&Q(e.prototype,n),i&&Q(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}(),L={};function P(t,e){var n=L[t];return n||(n=new R(t,e),L[t]=n),n.setTitle(e),n}function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function M(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,N(i.key),i)}}function B(t,e,n){return(e=N(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(t){var e=function(t,e){if("object"!==I(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==I(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===I(e)?e:String(e)}!function(t){t[t.ERROR=0]="ERROR",t[t.UNSET=1]="UNSET",t[t.WRONG=2]="WRONG",t[t.RIGHT=3]="RIGHT"}(D||(D={}));var F=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),B(this,"status",D.UNSET),B(this,"lang","ca"),this.spanStatus=document.createElement("span"),this.spanStatus.setAttribute("data-toggle","tooltip"),this.spanHint=e("span",{dataToggle:"tooltip",class:"ib-quizz-hint",title:"Mostrar pista",style:"display:none;",html:'<i class="'.concat("fa fas fa-life-ring",'"></i>')}),this.feedbackSpan=e("span",{class:"ib-quizz-feedback",dataToggle:"tooltip",title:"Mostrar solució",style:"display:none;",html:'<i class="'.concat("fa fas fa-question",'"></i>')}),this.divBlock=e("div",{style:"display:inline-block;"}),this.divBlock.append(this.spanStatus),this.divBlock.append(this.spanHint),this.divBlock.append(this.feedbackSpan)}var n,i,r;return n=t,(i=[{key:"setStatus",value:function(t,e){this.status=t;var n=this.spanStatus.classList,i=e;switch(t){case D.UNSET:n.remove("ib-quizz-right","ib-quizz-wrong","ib-quizz-error"),this.spanStatus.innerHTML="";break;case D.RIGHT:n.add("ib-quizz-right"),i||(i=z(this.lang,"right")),this.spanStatus.innerHTML='<i class="'.concat("fa fas fa-check",'"></i>');break;case D.WRONG:n.add("ib-quizz-wrong"),i||(i=z(this.lang,"wrong")),this.spanStatus.innerHTML='<i class="'.concat("fa fas fa-times",'"></i>');break;default:n.add("ib-quizz-error"),i||(i=z(this.lang,"error")),this.spanStatus.innerHTML='<i class="'.concat("fa fas fa-exclamation",'"></i>')}i&&this.spanStatus.setAttribute("title",i)}},{key:"getStatus",value:function(){return this.status}},{key:"setLang",value:function(t){this.lang=t}},{key:"setHint",value:function(t){this.spanHint.addEventListener("click",(function(){var n=P("ib-quizz-modal-dlg","Una pista..."),i=e("div",{html:t});n.setBody(i),n.show()})),this.spanHint.style.setProperty("display","")}},{key:"setFeedback",value:function(t){this.feedbackSpan.addEventListener("click",(function(){var n=P("ib-quizz-modal-dlg","Retroacció"),i=e("div",{html:t});n.setBody(i),n.show()})),this.spanHint.style.setProperty("display","none"),this.feedbackSpan.style.setProperty("display","")}},{key:"getElement",value:function(){return this.divBlock}}])&&M(n.prototype,i),r&&M(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function U(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,tt(i.key),i)}}function W(t,e){if(e&&("object"===H(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return G(t)}function G(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X(t){var e="function"==typeof Map?new Map:void 0;return X=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return V(t,arguments,K(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),J(i,t)},X(t)}function V(t,e,n){return V=Z()?Reflect.construct.bind():function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&J(r,n.prototype),r},V.apply(null,arguments)}function Z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},J(t,e)}function K(t){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},K(t)}function Y(t,e,n){return(e=tt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tt(t){var e=function(t,e){if("object"!==H(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==H(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===H(e)?e:String(e)}var et,nt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}(a,t);var e,n,i,r,o,s=(e=a,n=Z(),function(){var t,i=K(e);if(n){var r=K(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return W(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Y(G(t=s.call(this)),"lang","ca"),Y(G(t),"_syncCount",0),Y(G(t),"attempts",0),Y(G(t),"hintSet",!1),Y(G(t),"feedbackSet",!1),t.innerHTML="",t.classList.add("d-print-none"),t.statusDisplay=new F,t}return i=a,(r=[{key:"init",value:function(t){if(t){var e=document.createElement("span");e.innerHTML=t,this.prepend(e)}}},{key:"connectedCallback",value:function(){var t=this.dataset.src||"";try{t=atob(t),this.widgetConfig=JSON.parse(t)}catch(t){return void console.error(t)}console.log("Widget config is ",this.widgetConfig),this._syncCount++,3===this._syncCount&&this.render()}},{key:"reflowLatex",value:function(){window.MathJax&&(window.MathJax.typesetPromise&&window.MathJax.typesetPromise(),window.MathJax.Hub&&window.MathJax.Hub.Queue&&window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub]))}},{key:"setLang",value:function(t){this.lang=t,this.statusDisplay.setLang(t),console.log("Setting lang ",t),this._syncCount++,3===this._syncCount&&this.render()}},{key:"setGroupContext",value:function(t){this.groupContext=t,console.log("Setting context ",this.groupContext),this._syncCount++,3===this._syncCount&&this.render()}},{key:"setStatus",value:function(t,e){this.statusDisplay.setStatus(t,e)}},{key:"incAttempts",value:function(){var t,e,n,i;this.attempts++;var r,o,s=(null===(t=this.groupContext)||void 0===t?void 0:t.o.hint)||0,a=(null===(e=this.groupContext)||void 0===e?void 0:e.o.ans)||0;!this.hintSet&&s>0&&this.attempts>=s&&null!==(n=this.widgetConfig)&&void 0!==n&&n.hint&&(this.hintSet=!0,this.statusDisplay.setHint(null===(r=this.widgetConfig)||void 0===r?void 0:r.hint)),!this.feedbackSet&&a>0&&this.attempts>=a&&null!==(i=this.widgetConfig)&&void 0!==i&&i.fbk&&(this.feedbackSet=!0,this.statusDisplay.setFeedback(null===(o=this.widgetConfig)||void 0===o?void 0:o.fbk))}},{key:"showFeedback",value:function(){var t,e;!this.feedbackSet&&null!==(t=this.widgetConfig)&&void 0!==t&&t.fbk&&(this.feedbackSet=!0,this.statusDisplay.setFeedback(null===(e=this.widgetConfig)||void 0===e?void 0:e.fbk))}}])&&U(i.prototype,r),o&&U(i,o),Object.defineProperty(i,"prototype",{writable:!1}),a}(X(HTMLElement));function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,pt(i.key),i)}}function st(){return st="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=at(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},st.apply(this,arguments)}function at(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ht(t)););return t}function lt(t,e){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lt(t,e)}function ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ht(t);if(e){var r=ht(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ut(this,n)}}function ut(t,e){if(e&&("object"===it(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ft(t)}function ft(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ht(t){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ht(t)}function dt(t,e,n){return(e=pt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pt(t){var e=function(t,e){if("object"!==it(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==it(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===it(e)?e:String(e)}var mt;E({elementName:"ib-quizz-dropdown",classes:["ib-quizz-elem"],styles:{display:"inline-block"}})(et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lt(t,e)}(a,t);var n,r,o,s=ct(a);function a(){var t;rt(this,a);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return dt(ft(t=s.call.apply(s,[this].concat(n))),"userAns",-1),t}return n=a,(r=[{key:"enable",value:function(t){this.button&&(this.button.disabled=!t)}},{key:"getUserInput",value:function(){return this.userAns+""}},{key:"displayRightAnswer",value:function(){this.enable(!1)}},{key:"check",value:function(){var t,e=(null===(t=this.widgetConfig)||void 0===t?void 0:t.ans)===this.userAns+"";return this.setStatus(e?D.RIGHT:D.WRONG),this.enable(!e),e?this.showFeedback():this.incAttempts(),e}},{key:"setLang",value:function(t){st(ht(a.prototype),"setLang",this).call(this,t),this.button&&(this.button.innerHTML=z(t,"chooseone"))}},{key:"render",value:function(){var t,n,r,o,s,l=this;if(this.widgetConfig){if(null!==(t=this.groupContext)&&void 0!==t&&t.s.length){var c,u=(null===(c=this.widgetConfig)||void 0===c?void 0:c.vars)||[];u.forEach((function(t,e){t.indexOf("#")<0||(u[e]=t.replace(/#([a-zA-Z0-9_]+)/g,(function(t,e){var n;return(null===(n=l.groupContext)||void 0===n?void 0:n._s[e])||t})))}))}if(this.dropdown=e("div",{class:"dropdown",style:"display:inline-block;"}),console.log("connectedCallback ",this.widgetConfig),this.widgetConfig){this.button=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",html:z(this.lang,"chooseone")}),this.options=e("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton"});for(var f=(null===(n=this.widgetConfig)||void 0===n||null===(r=n.vars)||void 0===r?void 0:r.length)||0,h=new Array(f),d=0;d<f;d++)h[d]=d;null!==(o=this.widgetConfig)&&void 0!==o&&null!==(s=o.opts)&&void 0!==s&&s.shuffle&&i(h),h.forEach((function(t){var n,i,r=((null===(n=l.widgetConfig)||void 0===n?void 0:n.vars)||[])[t],o=e("a",{class:"dropdown-item",href:"#","data-index":t+"",html:r});o.addEventListener("click",(function(e){l.userAns=t,e.preventDefault(),l.button&&(l.button.innerHTML=r),r.indexOf("\\(")>=0&&l.reflowLatex(),l.setStatus(D.UNSET)})),null===(i=l.options)||void 0===i||i.append(o)})),this.dropdown.append(this.button),this.dropdown.append(this.options),st(ht(a.prototype),"init",this).call(this,this.widgetConfig.pre),this.append(this.dropdown),this.append(this.statusDisplay.getElement()),this.reflowLatex()}}}}])&&ot(n.prototype,r),o&&ot(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(nt));function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Ct(i.key),i)}}function yt(){return yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=wt(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},yt.apply(this,arguments)}function wt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}function qt(t,e){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qt(t,e)}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=St(t);if(e){var r=St(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return kt(this,n)}}function kt(t,e){if(e&&("object"===bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ot(t)}function Ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},St(t)}function jt(t,e,n){return(e=Ct(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ct(t){var e=function(t,e){if("object"!==bt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==bt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===bt(e)?e:String(e)}function Tt(t){return function(t){if(Array.isArray(t))return Et(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var _t;E({elementName:"ib-quizz-mchoice",classes:["iedib-quizz-widget"],styles:{display:"flex","align-items":"center"}})(mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qt(t,e)}(a,t);var n,r,o,s=xt(a);function a(){var t;gt(this,a);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return jt(Ot(t=s.call.apply(s,[this].concat(n))),"radios",[]),jt(Ot(t),"userAnsSet",new Set),t}return n=a,(r=[{key:"enable",value:function(t){var e;null===(e=this.radios)||void 0===e||e.forEach((function(e){var n,i;t?(e.disabled=!1,null===(n=e.parentElement)||void 0===n||n.classList.remove("disabled")):(e.disabled=!0,null===(i=e.parentElement)||void 0===i||i.classList.add("disabled"))}))}},{key:"getUserInput",value:function(){return Tt(this.userAnsSet).join(",")}},{key:"displayRightAnswer",value:function(){this.enable(!1)}},{key:"check",value:function(){var t,e,n,i,r=((null===(t=this.widgetConfig)||void 0===t?void 0:t.ans)||"").split(",").map((function(t){return t.trim()})),o=new Set(r),s=(e=this.userAnsSet,n=o,(i=new Set([].concat(Tt(e),Tt(n)))).size==e.size&&i.size==n.size);return this.setStatus(s?D.RIGHT:D.WRONG),this.enable(!s),s?this.showFeedback():this.incAttempts(),s}},{key:"render",value:function(){var t,n,r,o,s,l,c=this;if(console.log("MCHOICE RENDER:: ",this.groupContext,this.widgetConfig),this.widgetConfig){if(null!==(t=this.groupContext)&&void 0!==t&&t.s.length){var u,f=(null===(u=this.widgetConfig)||void 0===u?void 0:u.vars)||[];console.log("The vars,",f),f.forEach((function(t,e){console.log("Searching for # in ",t),t.indexOf("#")<0||(f[e]=t.replace(/#([a-zA-Z0-9_]+)/g,(function(t,e){var n;return(null===(n=c.groupContext)||void 0===n?void 0:n._s[e])||t})))}))}this.form=document.createElement("form"),this.form.style.setProperty("display","inline-block");for(var h=(null===(n=this.widgetConfig)||void 0===n?void 0:n.ans.indexOf(","))>0,d=(null===(r=this.widgetConfig)||void 0===r||null===(o=r.vars)||void 0===o?void 0:o.length)||0,p=new Array(d),m=0;m<d;m++)p[m]=m;null!==(s=this.widgetConfig)&&void 0!==s&&null!==(l=s.opts)&&void 0!==l&&l.shuffle&&i(p);var b="i"+Math.random().toString(32).substring(2);p.forEach((function(t){var n,i,r=((null===(n=c.widgetConfig)||void 0===n?void 0:n.vars)||[])[t],o=e("div",{class:"form-check"});null===(i=c.form)||void 0===i||i.append(o);var s=e("input",{class:"form-check-input",type:h?"checkbox":"radio",name:b,id:b+"_"+t}),a=e("label",{class:"form-check-label",for:b+"_"+t,html:r});o.appendChild(s),o.appendChild(a),c.radios.push(s),s.addEventListener("click",(function(e){s.checked?c.userAnsSet.add(t+""):c.userAnsSet.delete(t+""),c.setStatus(D.UNSET)}))})),yt(St(a.prototype),"init",this).call(this,this.widgetConfig.pre),this.append(this.form),this.append(this.statusDisplay.getElement()),this.reflowLatex()}}}])&&vt(n.prototype,r),o&&vt(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(nt));function zt(t,e,n){return zt=At()?Reflect.construct.bind():function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&Qt(r,n.prototype),r},zt.apply(null,arguments)}function At(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Qt(t,e){return Qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qt(t,e)}function Dt(t){return function(t){if(Array.isArray(t))return Rt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Rt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Lt(t,e){t=t||{};var n=Object.keys(t),i=[].concat(n,["expr","return eval(expr)"]),r=zt(Function,Dt(i)),o=Object.values(t),s=[].concat(o,[e]);return r.apply(void 0,Dt(s))}function Pt(t,e,n){e=e||{},n=n||{};var i=Object.keys(e),r=Object.values(e);return zt(Function,i.concat([t])).apply(n,r)}function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Vt(i.key),i)}}function Nt(){return Nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Ft(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},Nt.apply(this,arguments)}function Ft(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gt(t)););return t}function Ht(t,e){return Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ht(t,e)}function $t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gt(t);if(e){var r=Gt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Ut(this,n)}}function Ut(t,e){if(e&&("object"===It(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wt(t)}function Wt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gt(t){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gt(t)}function Xt(t,e,n){return(e=Vt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vt(t){var e=function(t,e){if("object"!==It(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==It(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===It(e)?e:String(e)}var Zt;E({elementName:"ib-quizz-numeric",classes:["iedib-quizz-widget"],styles:{display:"inline-block"}})(_t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ht(t,e)}(s,t);var n,i,r,o=$t(s);function s(){var t;Mt(this,s);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Xt(Wt(t=o.call.apply(o,[this].concat(n))),"userAns",-1),t}return n=s,(i=[{key:"enable",value:function(t){this.input&&(this.input.disabled=!t)}},{key:"getUserInput",value:function(){var t;return(null===(t=this.input)||void 0===t?void 0:t.value)||""}},{key:"displayRightAnswer",value:function(){var t;this.input&&(this.input.value=(null===(t=this.widgetConfig)||void 0===t?void 0:t.ans)||"",this.enable(!1))}},{key:"check",value:function(){var t=!1;try{var e,n,i=parseFloat(this.getUserInput()),r=parseFloat((null===(e=this.widgetConfig)||void 0===e?void 0:e.ans)||"0");if(isNaN(i)||isNaN(r))return console.error("ERROR",this.getUserInput(),null===(n=this.widgetConfig)||void 0===n?void 0:n.ans),this.setStatus(D.ERROR),!1;var o,s,a,l,c=(null===(o=this.widgetConfig)||void 0===o||null===(s=o.opts)||void 0===s?void 0:s.err)||0,u=(null===(a=this.widgetConfig)||void 0===a||null===(l=a.opts)||void 0===l?void 0:l.errunit)||"absolute";"%"===u&&(c*=.01),0===r&&(u="absolute"),t="absolute"===u?Math.abs(i-r)<=c:Math.abs(i/r-1)<=c}catch(t){return console.error(t),this.setStatus(D.ERROR),!1}return this.setStatus(t?D.RIGHT:D.WRONG),console.log("Numeric, ",this.getUserInput(),t),this.enable(!t),t?this.showFeedback():this.incAttempts(),t}},{key:"render",value:function(){var t,n=this;if(this.widgetConfig){if(null!==(t=this.groupContext)&&void 0!==t&&t.s.length&&this.widgetConfig){var i=this.widgetConfig.ans||"";i.indexOf("#")>=0&&(i=i.replace(/#/g,""),this.widgetConfig.ans=""+Lt(this.groupContext._s||{},i))}this.input=e("input",{class:"form-control",type:"number",style:"display:inline-block;width:100px;"}),this.input.addEventListener("change",(function(t){n.setStatus(D.UNSET)})),Nt(Gt(s.prototype),"init",this).call(this,this.widgetConfig.pre),this.append(this.input),this.append(this.statusDisplay.getElement()),this.reflowLatex()}}}])&&Bt(n.prototype,i),r&&Bt(n,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(nt));function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Kt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(r=i.key,o=void 0,o=function(t,e){if("object"!==Jt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==Jt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===Jt(o)?o:String(o)),i)}var r,o}function te(){return te="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=ee(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},te.apply(this,arguments)}function ee(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oe(t)););return t}function ne(t,e){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ne(t,e)}function ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=oe(t);if(e){var r=oe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return re(this,n)}}function re(t,e){if(e&&("object"===Jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oe(t){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oe(t)}var se;E({elementName:"ib-quizz-cloze",classes:["iedib-quizz-widget"],styles:{display:"inline-block"}})(Zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ne(t,e)}(o,t);var e,n,i,r=ie(o);function o(){return Kt(this,o),r.apply(this,arguments)}return e=o,(n=[{key:"enable",value:function(t){for(var e,n=(null===(e=this.mathInput)||void 0===e?void 0:e.innerFields)||[],i=0,r=n.length;i<r;i++)n[i].__controller.editable=t}},{key:"getUserInput",value:function(){return JSON.stringify(this.getUserInputArray())}},{key:"getUserInputArray",value:function(){var t,e,n=[];console.log(null===(t=this.mathInput)||void 0===t?void 0:t.innerFields);for(var i=(null===(e=this.mathInput)||void 0===e?void 0:e.innerFields)||[],r=0,o=i.length;r<o;r++)n.push((i[r].latex()||"").replace(/\\\s/g,"").trim());return n}},{key:"displayRightAnswer",value:function(){if(this.mathInput){for(var t,e=JSON.parse((null===(t=this.widgetConfig)||void 0===t?void 0:t.ans)||"[]"),n=this.mathInput.innerFields||[],i=0,r=n.length;i<r;i++)i<e.length&&e.push(n[i].latex(e[i]));this.enable(!1)}}},{key:"check",value:function(){var t=!1;try{var e;if(null!==(e=this.widgetConfig)&&void 0!==e&&e.cfn){var n,i,r={u:this.getUserInputArray()};Object.assign(r,null===(n=this.groupContext)||void 0===n?void 0:n._s),r.u.forEach((function(t,e){return r["u"+e]=t}));var o=((null===(i=this.widgetConfig)||void 0===i?void 0:i.cfn)||"return true").replace(/#/g,"");t=Pt(o,r,{}),console.log("Avaluant ",o,"Retorna ",t)}else{var s,a=(null===(s=this.widgetConfig)||void 0===s?void 0:s.ans)||"[]";"string"==typeof a&&(a=JSON.parse(a)),console.log(a);var l=this.getUserInputArray();t=!0;for(var c=0,u=l.length;c<u;c++)t=c<a.length&&t&&a[c]==(l[c]||"").trim()}}catch(t){return console.error(t),this.setStatus(D.ERROR),!1}return this.setStatus(t?D.RIGHT:D.WRONG),console.log("Matquill Cloze, ",this.getUserInput(),t),this.enable(!t),t?this.showFeedback():this.incAttempts(),t}},{key:"render",value:function(){var t,e=this;if(this.widgetConfig){if(console.log("Render numeric ",this.widgetConfig),null!==(t=this.groupContext)&&void 0!==t&&t.s.length&&this.widgetConfig){var n=this.widgetConfig.ans||"";n.indexOf("#")>=0&&(n=n.replace(/#/g,""),this.widgetConfig.ans=""+Lt(this.groupContext._s||{},n))}var i;this.input=document.createElement("span"),this.input.innerText=(i=this.widgetConfig.ini||"?",i?i.replace(/V\[(\d+)\]/g,(function(t,e){var n=parseInt(e);return"\\left("+new Array(n).fill("\\MathQuillMathField{}").join(",")+"\\right)"})).replace(/M\[(\d+)x(\d+)\]/g,(function(t,e,n){var i=parseInt(e),r=parseInt(n),o=new Array(i).fill("\\MathQuillMathField{}").join(" & ");return"\\begin{pmatrix}"+new Array(r).fill(o).join(" \\\\ ")+"\\end{pmatrix}"})):i).replace(/\?/g,"\\MathQuillMathField{ }"),console.log(this.input.innerText),this.append(this.input);var r=window.MathQuill.getInterface(2);this.mathInput=r.StaticMath(this.input),this.mathInput.innerFields.forEach((function(t){t.__controller.textarea.on("keyup",(function(t){t.preventDefault(),e.setStatus(D.UNSET)}))})),te(oe(o.prototype),"init",this).call(this,this.widgetConfig.pre),this.append(this.statusDisplay.getElement()),this.reflowLatex()}}}])&&Yt(e.prototype,n),i&&Yt(e,i),Object.defineProperty(e,"prototype",{writable:!1}),o}(nt));function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function le(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,pe(i.key),i)}}function ce(t,e){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ce(t,e)}function ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=de(t);if(e){var r=de(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return fe(this,n)}}function fe(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return he(t)}function he(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}function pe(t){var e=function(t,e){if("object"!==ae(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==ae(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ae(e)?e:String(e)}var me,be;o([(me={name:"quizz",author:"Josep Mulet Pol",version:"1.0",query:"[data-quizz-group]",use$:!0},(be=Object.assign({},T,me)).query||(be.query='[role="snptd_'.concat(be.name,'"],[data-snptd="').concat(be.name,'"]')),function(t){t.meta=be}(se=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ce(t,e)}(s,t);var n,i,r,o=ue(s);function s(t){var n,i,r,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),n=o.call(this,t),i=he(n),a={s:"",_s:{},o:{hint:2,ans:4}},(r=pe(r="groupContext"))in i?Object.defineProperty(i,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[r]=a;var l,c=t.getAttribute("data-lang");c||(c=(null===(l=t.parentElement)||void 0===l?void 0:l.getAttribute("data-lang"))||null);var u=t.getAttribute("data-quizz-group")||"";try{var f=atob(u)||"{}";console.log(f);var h=JSON.parse(f);n.groupContext=Object.assign(n.groupContext,h),console.log(f,h,n.groupContext)}catch(t){console.error(t)}return n.lang=c||"ca",n.generateGroup(),n.findPlaceholders(),n.allQuizzElements=n.parent.querySelectorAll(".ib-quizz-elem"),console.log(n.allQuizzElements),n.checkButton=e("button",{class:"btn btn-sm btn-primary d-print-none",style:"margin: 10px",html:'<i class="fa fas fa-check"></i> '+z(n.lang,"check")}),n.parent.append(n.checkButton),n.listener=function(t){t.preventDefault();var e=!0;n.allQuizzElements.forEach((function(t){var n=t.check();e=e&&n})),e&&n.checkButton.setAttribute("disabled","true")},n}return n=s,(i=[{key:"generateGroup",value:function(){var t={};Object.defineProperty(t,"alea",{value:function(t,e){return Math.floor((e-t)*Math.random())+t},enumerable:!0,configurable:!1,writable:!1}),Object.defineProperty(t,"dec",{value:function(t,e){var n=Math.pow(10,e);return Math.floor(t*n)/n},enumerable:!0,configurable:!1,writable:!1});try{Pt(this.groupContext.s.replace(/#/g,"this."),t,this.groupContext._s)}catch(t){console.error("GroupContext:: No es pot interpretar el codi.\n",t)}if(this.groupContext.s.trim().length){var n=e("div",{class:"alert alert-info",html:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="height:20px;"><path fill="#154b5e" d="M592 192H473.26c12.69 29.59 7.12 65.2-17 89.32L320 417.58V464c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48V240c0-26.51-21.49-48-48-48zM480 376c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24zm-46.37-186.7L258.7 14.37c-19.16-19.16-50.23-19.16-69.39 0L14.37 189.3c-19.16 19.16-19.16 50.23 0 69.39L189.3 433.63c19.16 19.16 50.23 19.16 69.39 0L433.63 258.7c19.16-19.17 19.16-50.24 0-69.4zM96 248c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24zm128 128c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24zm0-128c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24zm0-128c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24zm128 128c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"/></svg> \n                <small>'.concat(z(this.lang,"random_msg"),"</small>")}),i=this.parent.querySelector(":nth-child(2)");"H4"===(null==i?void 0:i.nodeName)?this.parent.insertBefore(n,i.nextSibling):this.parent.prepend(n)}}},{key:"findPlaceholders",value:function(){var t=this;0!==this.groupContext.s.trim().length&&function(t){for(var e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),i=n.nextNode();null!=i;)e.push(i),i=n.nextNode();return e}(this.parent).forEach((function(e){var n=e.nodeValue||"";if(!(n.indexOf("#")<0)){var i=n.replace(/#([a-zA-Z0-9_]+)/g,(function(e,n){return t.groupContext._s[n]}));e.nodeValue=i}}))}},{key:"init",value:function(){var t=this,e=this.parent.dataset;"1"!==e.active&&(e.active="1",this.checkButton.addEventListener("click",this.listener),this.allQuizzElements.forEach((function(e){"function"==typeof e.setLang?(e.setLang(t.lang),e.setGroupContext(t.groupContext)):console.error("No custom element registered for ",e)})))}},{key:"dispose",value:function(){"0"!==this.parent.dataset.active&&(this.parent.removeAttribute("data-active"),this.checkButton.removeEventListener("click",this.listener))}}])&&le(n.prototype,i),r&&le(n,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(S))||se)])}()}();